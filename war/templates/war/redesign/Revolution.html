{% extends 'player/redesign/header.html' %}
{% load l10n %}{% load i18n %}
{% load static %}
{% load tz %}
{% load has_key %}
{% load dict_key %}
{% load get_attr %}
{% load get_sum %}
{% load redesign.template_svg.nopic %}

{% block for_scripts_and_css %}
<script>
    const war_id = '{{ war.pk }}';
    const defence_points = {% localize off %}{{ war.defence_points }}{% endlocalize %};
    const war_type = 'Revolution';

    const player_pwr = {% localize off %}{{ player.power }}{% endlocalize %};

    const chat_conn_type = "{% if http_use %}ws{% else %}wss{% endif %}";
</script>

<script src='{% static "js/EventWar.js" %}?{{ csrf_token }}'></script>
{% if war.running %}
<script src='{% static "js/war_socket.js" %}?{{ csrf_token }}'></script>
{% endif %}
<script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
{% endblock %}

{% block content %}
<script>
    var units_energy = {};
    var units_damage = {};
    var units_mod = {};

    var coherence_perk = {% if coherence_perk %}true{% else %}false{% endif %};
    var scouting_perk = {% if scouting_perk %}{{ scouting_perk }}{% else %}0{% endif %};

    {% for unit in units %}

        units_energy['{% localize off %}{{ unit.pk }}{% endlocalize %}'] = {% localize off %}{{ unit.energy }}{% endlocalize %};

        units_damage['{% localize off %}{{ unit.pk }}{% endlocalize %}'] = {% localize off %}{{ unit.damage }}{% endlocalize %};

        units_mod['{% localize off %}{{ unit.pk }}{% endlocalize %}'] = {% localize off %}{{ modifiers_dict|dict_key:unit.pk }}{% endlocalize %};

    {% endfor %}
</script>
<section class="war">
    <!-- Заголовок -->
    <h1 class="war__title ct__page-title">{% trans 'Восстание в регионе' context "war_page" %} {{ war.def_region.region_name }}</h1>

    <div class="war__top">
      <div class="war__type">

        {% for terrain in terrains %}
            {% if terrain.title == 'Холмы' %}
            <!--холмы-->
            <svg width="32rem" height="32rem" viewBox="0 0 34 34" fill="none" version="1.1" id="svg139" sodipodi:docname="hills.svg" xml:space="preserve" inkscape:version="1.2.1 (9c6d41e410, 2022-07-14)" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns="http://www.w3.org/2000/svg" xmlns:svg="http://www.w3.org/2000/svg"><defs id="defs143"></defs>
                <sodipodi:namedview id="namedview141" pagecolor="#ffffff" bordercolor="#111111" borderopacity="1" inkscape:showpageshadow="0" inkscape:pageopacity="0" inkscape:pagecheckerboard="1" inkscape:deskcolor="#d1d1d1" showgrid="false" inkscape:zoom="32" inkscape:cx="13.140625" inkscape:cy="14.9375" inkscape:window-width="3440" inkscape:window-height="1417" inkscape:window-x="-8" inkscape:window-y="-8" inkscape:window-maximized="1" inkscape:current-layer="g4295"></sodipodi:namedview>
                <circle cx="17" cy="17" r="16.5" stroke="var(--c10two)" id="circle135" style="display:inline"></circle>
                <g id="g4295" style="display:inline">
                    <path id="path2626" style="display:inline;fill:var(--c10one);fill-opacity:1;stroke:none;stroke-width:5.03925" d="m 13.583984,10.970703 c -0.0718,0.0038 -0.138753,0.0098 -0.201172,0.02149 -0.998699,0.187274 -0.861957,-0.312049 -3.6210932,2.054687 -2.759137,2.366737 -8.4140626,7.599609 -8.4140626,7.599609 l 1.234375,-0.0039 8.7773438,-7.84375 c 0.220699,-0.168772 0.75863,-0.587132 1.148437,-0.71875 0.233725,-0.07892 0.581726,-0.184923 0.902344,-0.185547 0.05559,0.409197 0.04795,0.804188 0.01563,1.191407 -0.08887,0.412762 -0.17145,0.836315 -0.324219,1.142578 -0.115319,0.402677 -0.201823,0.816873 -0.164062,1.285156 0.277208,1.159217 1.177586,2.065527 2.001953,3.232422 0.306094,0.60875 0.467506,1.264295 0.607422,1.873047 l 1.304687,-0.0059 5.283204,-4.841797 c 0.315544,-0.297456 0.587721,-0.559251 0.943359,-0.740234 0.276581,-0.140751 0.574404,-0.218134 0.894531,-0.253906 0.07017,0.167522 0.120592,0.360195 0.0957,0.546875 -0.06225,0.466924 -0.228862,0.804391 -0.179687,1.208984 0.05056,0.415998 0.40718,0.709046 0.621094,1.056641 0.231668,0.376445 0.508627,0.725303 0.716796,1.115234 0.162916,0.305165 0.326173,0.616593 0.414063,0.951172 0.08018,0.305222 0.09943,0.937397 0.09961,0.943359 l 6.837891,-0.01367 -6.396484,-5.5625 c -0.142671,-0.07023 -0.503382,-0.440914 -0.908203,-0.671876 -0.404822,-0.230957 -0.870475,-0.306613 -1.322266,-0.283203 -0.239476,0.01241 -0.644353,0.05632 -1.009766,0.248047 -0.323971,0.169989 -0.635213,0.412907 -0.925781,0.681641 l -1.199219,1.109375 c 0,0 -1.744795,-1.629566 -3.353515,-2.955078 -0.804362,-0.662759 -1.364632,-1.295782 -2.058594,-1.69336 -0.607217,-0.347881 -1.317739,-0.514634 -1.820313,-0.488281 z" sodipodi:nodetypes="scscccsccccccccscssssscccsssccssss">
                    </path>
                </g>
            </svg>
            {% endif %}

            {% if terrain.title == 'Горы' %}
            <!--горы-->
            <svg width="32rem" height="32rem" viewBox="0 0 34 34" fill="none" version="1.1" id="svg139" sodipodi:docname="mountains.svg" xml:space="preserve" inkscape:version="1.2.1 (9c6d41e410, 2022-07-14)" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns="http://www.w3.org/2000/svg" xmlns:svg="http://www.w3.org/2000/svg"><defs id="defs143">

            </defs>
                <sodipodi:namedview id="namedview141" pagecolor="#ffffff" bordercolor="#111111" borderopacity="1" inkscape:showpageshadow="0" inkscape:pageopacity="0" inkscape:pagecheckerboard="1" inkscape:deskcolor="#d1d1d1" showgrid="false" inkscape:zoom="16" inkscape:cx="-13.9375" inkscape:cy="24.3125" inkscape:window-width="3440" inkscape:window-height="1417" inkscape:window-x="-8" inkscape:window-y="-8" inkscape:window-maximized="1" inkscape:current-layer="svg139"></sodipodi:namedview><circle cx="17" cy="17" r="16.5" stroke="var(--c10two)" id="circle135" style="display:inline" sodipodi:insensitive="true"></circle><path id="path4487" style="display:inline;fill:var(--c10one);fill-opacity:1;stroke:none;stroke-width:5" d="M 17.90625 6.8105469 C 17.495226 6.8581348 16.906434 7.3271633 16.878906 7.3632812 L 12.607422 12.966797 C 12.324921 12.694143 12.088363 12.196039 11.287109 12.130859 C 10.791211 12.090519 10.203319 12.784308 9.7910156 13.224609 L 2.4960938 23.423828 C 2.8522222 23.775541 3.2744946 24.100753 4.0097656 24.306641 L 7.7324219 24.375 C 9.8115111 23.762537 11.85318 23.125142 13.820312 22.570312 C 15.516012 22.092042 16.880451 21.769719 18.359375 21.640625 C 19.963327 21.500617 24.616682 21.635125 23.023438 21.867188 C 23.023438 21.867188 20.380717 22.212096 19.054688 22.492188 C 17.991407 22.716778 16.751339 22.987366 15.742188 23.390625 C 14.849112 23.747498 13.870619 24.406192 12.886719 24.912109 L 13.015625 24.925781 L 18.650391 24.925781 C 20.418452 24.135703 22.363974 23.444385 24.394531 23.091797 C 27.632688 22.810046 29.333157 23.315215 31.376953 23.644531 L 19.330078 7.5039062 C 19.022414 7.1308392 18.369561 6.7922064 18.068359 6.8183594 C 18.019079 6.8054594 17.964968 6.8037399 17.90625 6.8105469 z M 11.1875 7.65625 A 3.8946116 3.3919029 0 0 0 7.4375 10.136719 A 3.90625 4.234375 0 0 0 6.1875 9.90625 A 3.90625 4.234375 0 0 0 2.28125 14.140625 A 3.90625 4.234375 0 0 0 4.4882812 17.947266 L 5.0859375 16.847656 A 3.0739737 3.09375 0 0 1 3.375 14.078125 A 3.0739737 3.09375 0 0 1 6.4492188 10.984375 A 3.0739737 3.09375 0 0 1 8.0195312 11.421875 A 2.5853591 2.538403 0 0 1 8.2792969 11.605469 A 2.9333882 3.104641 0 0 1 11.205078 8.6074219 A 2.9333882 3.104641 0 0 1 13.316406 9.5605469 L 13.939453 8.6484375 A 3.8946116 3.3919029 0 0 0 11.1875 7.65625 z M 17.919922 8.3300781 C 18.044174 8.3280181 18.341797 8.7324219 18.341797 8.7324219 L 23.375 15.359375 C 23.375 15.359375 23.514443 15.505005 23.449219 15.630859 C 23.383999 15.756717 23.015625 15.652344 23.015625 15.652344 C 22.236812 15.426219 21.738985 15.405467 21.011719 15.333984 C 20.21094 15.280204 19.147152 15.365055 18.429688 15.644531 C 17.54329 15.859946 16.75159 16.266931 15.933594 16.619141 C 14.82073 17.074182 13.853643 18.134731 12.904297 18.142578 C 12.904297 18.142578 10.914938 18.268974 10.050781 18.050781 C 9.5939443 17.935432 9.1386442 17.772584 8.8300781 17.5625 C 8.7034998 17.47632 8.5057562 17.395936 8.4921875 17.230469 C 8.4888475 17.189709 8.5546875 17.101563 8.5546875 17.101562 L 10.800781 14.033203 C 10.957617 13.818949 11.141531 13.494983 11.40625 13.515625 C 11.577719 13.528995 11.742188 13.908203 11.742188 13.908203 C 11.742188 13.908203 12.214205 14.835662 12.488281 14.988281 C 12.762361 15.1409 13.054687 14.855469 13.054688 14.855469 L 17.546875 8.734375 C 17.546875 8.734375 17.79567 8.3321362 17.919922 8.3300781 z M 23.039062 9.8769531 L 23.886719 11.103516 A 3.3984375 3.7109375 0 0 1 25.617188 12.751953 A 2.988631 3.0797818 0 0 1 25.935547 12.498047 L 25.9375 12.501953 A 3.0612735 2.935152 86.29685 0 1 29.027344 12.34375 A 3.0612735 2.935152 86.29685 0 1 30.189453 16.505859 A 3.0612735 2.935152 86.29685 0 1 29.091797 17.671875 L 29.525391 18.382812 A 4.0905026 3.8204985 45.921249 0 0 31.207031 16.794922 A 4.0905026 3.8204985 45.921249 0 0 29.476562 11.361328 A 4.0905026 3.8204985 45.921249 0 0 25.625 11.255859 A 3.3984375 3.7109375 0 0 0 23.039062 9.8769531 z M 25.904297 24.099609 C 25.515511 24.104209 25.164352 24.119768 24.890625 24.148438 C 23.430751 24.301315 21.124365 24.971386 21.203125 25.085938 C 22.637077 25.041448 23.778132 25.375398 24.984375 25.429688 C 25.106557 25.435187 29.829548 24.182287 29.898438 24.304688 C 29.985157 24.250408 27.589034 24.079506 25.904297 24.099609 z "></path>
            </svg>
            {% endif %}

            {% if terrain.title == 'Леса' %}
            <!--леса-->
            <svg width="32rem" height="32rem" viewBox="0 0 34 34" fill="none" version="1.1" id="svg139" sodipodi:docname="forest.svg" xml:space="preserve" inkscape:version="1.2.1 (9c6d41e410, 2022-07-14)" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns="http://www.w3.org/2000/svg" xmlns:svg="http://www.w3.org/2000/svg"><defs id="defs143"></defs>
                <sodipodi:namedview id="namedview141" pagecolor="#ffffff" bordercolor="#111111" borderopacity="1" inkscape:showpageshadow="0" inkscape:pageopacity="0" inkscape:pagecheckerboard="1" inkscape:deskcolor="#d1d1d1" showgrid="false" inkscape:zoom="11.313709" inkscape:cx="-18.561553" inkscape:cy="-6.0104076" inkscape:window-width="3440" inkscape:window-height="1417" inkscape:window-x="-8" inkscape:window-y="-8" inkscape:window-maximized="1" inkscape:current-layer="svg139"></sodipodi:namedview><circle cx="17" cy="17" r="16.5" stroke="var(--c10two)" id="circle135" style="display:inline" sodipodi:insensitive="true"></circle>
                <path id="path5022" style="fill:var(--c10one);stroke-width:0.0553985" d="m 16.903569,3.8177828 c -0.198246,0 -0.397147,0.078836 -0.529297,0.2360424 l -4.625,5.6594446 c -0.0661,0.188658 -0.06641,0.3782152 -0.06641,0.5668742 0.0661,0.188658 0.198231,0.312876 0.396484,0.43863 l 0.726563,0.377296 -2.378906,4.466222 c -0.13215,0.314413 0.0013,0.690173 0.265625,0.815926 l 0.726562,0.377297 -0.726562,1.321466 c -0.13215,0.314413 -6.85e-4,0.692031 0.263672,0.817786 0.0661,0.0629 0.197568,0.06319 0.263671,0.06319 0.264356,0 0.463497,-0.125734 0.595703,-0.377297 l 0.990235,-1.886481 c 0.13215,-0.314413 6.84e-4,-0.692031 -0.263672,-0.817785 l -0.726563,-0.377296 2.378907,-4.464364 c 0.132149,-0.314412 -0.0013,-0.692031 -0.265625,-0.817785 l -0.59375,-0.314104 3.634765,-4.403029 3.634766,4.403029 -0.595703,0.314104 c -0.330403,0.125754 -0.461868,0.503373 -0.263672,0.817785 l 2.378906,4.464364 -0.726562,0.377296 c -0.330403,0.125754 -0.463878,0.503372 -0.265625,0.817785 l 0.992187,1.886481 c 0.13215,0.314413 0.528973,0.439516 0.859375,0.250912 0.330403,-0.125755 0.461868,-0.503373 0.263672,-0.817785 l -0.726563,-1.319608 0.726563,-0.377296 c 0.330403,-0.125755 0.461925,-0.503373 0.263672,-0.817785 l -2.378906,-4.464364 0.728515,-0.377296 c 0.198253,-0.0629 0.330079,-0.251885 0.330079,-0.440489 0.0661,-0.188658 -6.64e-4,-0.3779269 -0.132813,-0.5036812 l -4.625,-5.6594446 C 17.300688,3.896619 17.101815,3.8177828 16.903569,3.8177828 Z M 9.0402881,5.1225217 c -0.2643563,0 -0.4631937,0.1254455 -0.529297,0.3141038 L 5.2063036,10.467863 c -0.1321496,0.125754 -0.1308594,0.315023 -0.1308594,0.503681 0.066103,0.188658 0.1979285,0.314392 0.3300781,0.377296 l 0.6601563,0.314104 -2.2460938,3.206089 c -0.066103,0.125755 -0.066406,0.314735 -0.066406,0.440489 0.066103,0.188658 0.1979285,0.314392 0.3300781,0.377296 l 0.7265625,0.377297 -2.3789063,4.466221 c -0.1321496,0.188659 -0.066103,0.43955 0,0.628208 0.1982529,0.188658 0.4638566,0.314104 0.6621094,0.314104 h 3.3027344 v 3.772963 c 0,0.377316 -0.2637074,0.628207 -0.6601562,0.628207 H 5.0754442 c -0.3965056,0 -0.6621093,0.252804 -0.6621093,0.630067 0,0.377262 0.2656605,0.628207 0.6621093,0.628207 h 0.6601563 c 1.1234137,0 1.9824218,-0.817435 1.9824218,-1.886481 v -3.772963 h 1.2558593 c -0.1321498,0.251562 -0.331044,0.565337 -0.529297,1.005504 -0.1321492,0.188658 -0.066103,0.441408 0,0.630066 0.066103,0.188658 0.3974505,0.250911 0.5957035,0.250911 h 5.2851559 v 3.772963 c 0,0.377317 -0.263708,0.628208 -0.660156,0.628208 h -0.660157 c -0.396505,0 -0.662109,0.252804 -0.662109,0.630066 0,0.377263 0.265661,0.628208 0.662109,0.628208 h 0.660157 c 1.123413,0 1.982421,-0.817436 1.982421,-1.886482 v -3.772963 h 9.251954 c 0.198253,0 0.4616,-0.125445 0.59375,-0.314103 0.132149,-0.188659 0.132149,-0.43955 0,-0.628208 l -0.527344,-0.94417 h 1.255859 v 3.772963 c 0,1.069046 0.859009,1.886481 1.982422,1.886481 h 0.660157 c 0.396505,0 0.660155,-0.250945 0.660155,-0.628207 0,-0.377263 -0.263707,-0.630067 -0.660155,-0.630067 H 28.20435 c -0.396505,0 -0.662109,-0.250945 -0.662109,-0.628207 v -3.772963 h 3.304687 c 0.198253,0 0.463497,-0.125446 0.595703,-0.314104 0.06605,-0.18855 0.0661,-0.376645 0,-0.628208 l -2.380859,-4.466221 0.728516,-0.377297 c 0.198252,-0.0629 0.264031,-0.251542 0.330078,-0.377296 0.0661,-0.188658 -3.03e-4,-0.376069 -0.06641,-0.501822 l -2.246093,-3.207949 0.660156,-0.314103 c 0.198253,-0.0629 0.264032,-0.251542 0.330078,-0.377297 0.0661,-0.188658 -3.03e-4,-0.377927 -0.06641,-0.503681 L 25.42896,5.373433 c -0.0661,-0.1257541 -0.264998,-0.2509113 -0.529297,-0.2509113 -0.198253,0 -0.397148,0.062253 -0.529297,0.2509113 l -1.982422,2.5165478 c -0.198253,0.2515625 -0.131487,0.6923192 0.132812,0.8809776 0.2643,0.1886579 0.727529,0.1251231 0.925782,-0.1263849 l 1.386719,-1.7600967 2.378906,3.6465782 -0.660157,0.314104 c -0.198253,0.0629 -0.264031,0.251542 -0.330078,0.377296 -0.0661,0.188659 -0.0017,0.377927 0.06445,0.503681 l 2.248047,3.20609 -0.662109,0.314104 c -0.330402,0.125754 -0.461868,0.503373 -0.263672,0.817785 l 2.181641,4.150259 h -5.882813 c -0.396505,0 -0.660156,0.252804 -0.660156,0.630066 0,0.125754 3.03e-4,0.188007 0.06641,0.250911 l 0.529297,1.005505 H 10.096928 l 0.529297,-0.942312 c 0.0661,-0.0629 0.06641,-0.126673 0.06641,-0.189577 0.0661,-0.314413 -0.198895,-0.628496 -0.529297,-0.6914 -0.13215,-0.06291 -0.2640321,-0.06291 -0.3300786,0 H 4.1496629 l 2.1796875,-4.15026 C 6.4615001,15.812895 6.3300346,15.435276 6.0656786,15.309522 L 5.4055223,14.995418 7.651616,11.789329 C 7.717719,11.600671 7.718022,11.411114 7.718022,11.222455 7.6519191,11.033797 7.5200938,10.908063 7.3879442,10.845159 L 6.7277879,10.531055 9.106694,6.8826182 10.493413,8.6445735 c 0.198253,0.251562 0.661425,0.3150428 0.925781,0.1263849 C 11.68355,8.5823 11.748306,8.1415433 11.550054,7.8899808 L 9.5676315,5.373433 C 9.4354823,5.1847747 9.2385405,5.1225217 9.0402881,5.1225217 Z M 9.7004439,24.617403 c -0.3965054,0 -0.6601558,0.250945 -0.6601558,0.628208 v 1.258274 c 0,0.377317 0.2637072,0.628207 0.6601558,0.628207 0.3965061,0 0.6601561,-0.250945 0.6601561,-0.628207 v -1.258274 c 0,-0.377317 -0.263707,-0.628208 -0.6601561,-0.628208 z m 9.2519531,0 c -0.396449,0 -0.660156,0.250945 -0.660156,0.628208 v 1.886481 c 0,0.251562 0.06481,0.439604 0.130859,0.628208 h -1.453125 c -0.396505,0 -0.660156,0.252804 -0.660156,0.630066 0,0.377263 0.263708,0.628208 0.660156,0.628208 h 3.964844 c 0.396506,0 0.660156,-0.250945 0.660156,-0.628208 0,-0.377262 -0.26365,-0.630066 -0.660156,-0.630066 h -0.660156 c -0.396506,0 -0.66211,-0.250945 -0.66211,-0.628208 v -1.886481 c 0,-0.377317 -0.263707,-0.628208 -0.660156,-0.628208 z m 5.287109,0 c -0.396505,0 -0.662109,0.250945 -0.662109,0.628208 v 1.258274 c 0,0.377317 0.265661,0.628207 0.662109,0.628207 0.396449,0 0.660157,-0.250945 0.660157,-0.628207 v -1.258274 c 0,-0.377317 -0.263708,-0.628208 -0.660157,-0.628208 z"></path>
            </svg>
            {% endif %}

            {% if terrain.title == 'Равнины' %}
            <!--поля-->
            <svg
               width="34"
               height="34"
               viewBox="0 0 34 34"
               fill="none"
               version="1.1"
               id="svg139"
               xml:space="preserve"
               xmlns="http://www.w3.org/2000/svg"
               xmlns:svg="http://www.w3.org/2000/svg">

               <path
               id="rect2722"
               style="fill:var(--c10one);fill-opacity:1;stroke-width:0.45"
               d="m 9.2283351,10.544304 3.4792779,0.576528 2.752952,0.880141 1.88705,2.565726 -4.063778,1.655307 z" />

               <path
               id="rect445"
               style="fill:var(--c10one);stroke:none;stroke-width:0.45;fill-opacity:1"
               d="m 23.339344,13.17959 5.711936,-0.608649 -5.917288,7.709294 -2.088765,3.923133 -1.69898,5.131789 -6.094644,-0.01513 0.723708,-2.507118 1.558799,-3.097358 3.167874,-5.261947 z"/>

               <circle
               cx="17"
               cy="17"
               r="16.5"
               stroke="var(--c10two)"
               id="circle135"
               style="display:inline"/>

                <path
               id="path1132"
               style="fill:none;stroke:var(--c10one);stroke-width:0.5;stroke-dasharray:none;stroke-opacity:1"
               d="m 24.549864,29.543805 c 0,0 1.11991,-3.328223 1.789864,-4.949747 0.558687,-1.352218 1.14686,-2.697818 1.856155,-3.977476 0.800283,-1.443811 2.695844,-4.154252 2.695844,-4.154252 m -7.5793,-3.248272 c 0,0 -3.723339,3.926787 -4.738207,5.312651 -0.432826,0.591051 -2.492594,3.828639 -3.532308,5.860003 -1.082906,2.115752 -1.70776,3.899225 -1.929269,4.578099 -0.062,0.190021 -0.07485,0.357875 -0.07485,0.357875 m 16.329232,-16.77154 c 0,0 -2.982951,3.174958 -4.283367,4.916628 -1.284132,1.719858 -2.47883,3.522382 -3.453218,5.434835 -0.817093,1.603726 -1.910841,4.639088 -2.335782,5.847902 -0.113551,0.323015 -0.114971,0.585835 -0.114971,0.585835 M 16.650155,14.794 c 0,0 -3.422303,3.38945 -3.720416,3.732207 -0.143775,0.165306 -2.189099,2.772405 -3.5288708,5.244772 -1.2668555,2.337811 -1.9529877,4.810183 -1.9529877,4.810183 M 9.0487567,10.529261 c 0,0 1.7431403,2.153269 2.4054083,3.074776 0.744618,1.036092 1.933495,2.861573 1.933495,2.861573 m -7.797097,-3.693494 2.1876116,3.469243 m 7.7229314,-4.220545 1.811961,2.541165 m 2.276776,-0.690885 c 0,0 3.484719,-0.777368 5.303515,-0.985508 1.971372,-0.225601 6.075392,-0.354336 6.075392,-0.354336 m -17.910193,3.859481 c 0,0 2.140987,-1.081558 3.354518,-1.533661 0.987054,-0.367729 3.198768,-0.995592 3.198768,-0.995592 M 5.4062498,10.15625 c 0,0 5.2617582,0.371847 7.7348052,1.029588 2.239593,0.595652 6.530819,2.657911 6.530819,2.657911"
             />



                <path
               id="path1328"
               style="fill:var(--c10one);fill-opacity:1;stroke:var(--c10one);stroke-width:0.485888;stroke-dasharray:none;stroke-opacity:1"
               d="m 25.853516,6.0195312 c -0.745617,-8.04e-5 -1.349996,0.5649416 -1.34961,1.2617188 -1.3e-5,0.00326 -1.3e-5,0.00651 0,0.00977 -0.194583,-0.097783 -0.411881,-0.1494254 -0.632812,-0.1503906 -0.745617,-8.07e-5 -1.349996,0.5649413 -1.34961,1.2617188 -3.86e-4,0.6967772 0.525868,1.1719557 1.271485,1.171875 l 2.007812,0.054687 2.16211,-0.00391 c 0.745613,8.02e-5 1.349995,-0.5649416 1.349609,-1.2617188 -7.68e-4,-0.696014 -0.604812,-1.259846 -1.349609,-1.2597656 -0.272788,3.814e-4 -0.539048,0.078012 -0.763672,0.2226563 0.0016,-0.014951 0.0029,-0.029927 0.0039,-0.044922 3.86e-4,-0.6967769 -0.603996,-1.2617987 -1.349609,-1.2617188 z"
                />

                <path
               id="path1328-6"
               style="fill:var(--c10one);fill-opacity:1;stroke:var(--c10one);stroke-width:0.428419;stroke-dasharray:none;stroke-opacity:1"
               d="m 16.123066,4.9009481 c -0.657428,-7.08e-5 -1.190324,0.4981228 -1.189984,1.112488 -1.1e-5,0.00291 -1.1e-5,0.00573 0,0.00864 -0.171568,-0.086215 -0.363165,-0.1317518 -0.557965,-0.1326028 -0.657429,-7.12e-5 -1.190325,0.4981225 -1.189984,1.1124886 -3.41e-4,0.6143653 0.46367,1.0333413 1.121099,1.0332708 l 1.770337,0.048222 1.906385,-0.00344 c 0.657425,7.06e-5 1.190323,-0.4981231 1.189983,-1.1124883 -6.77e-4,-0.6136925 -0.533278,-1.1108372 -1.189983,-1.1107663 -0.240524,3.363e-4 -0.475292,0.068785 -0.673348,0.1963211 0.0014,-0.013182 0.0026,-0.02639 0.0034,-0.039607 3.41e-4,-0.6143649 -0.532558,-1.1125583 -1.189983,-1.1124879 z"
                />
            </svg>
            {% endif %}
        {% endfor %}

      </div>

      <div class="war__sides">
        <div class="war__gerbs">
          <p>{% trans 'Атака' context "war_page" %}:</p>
          <img src="/static/img/regions/webp/{{ war.agr_region.on_map_id }}.webp">
        </div>

        <p>
          {% if not war.running %}
            <span>{% trans 'Война завершилась' context "war_page" %}:</span><br>
            <span>{{ war.end_time|timezone:player.time_zone|date:"d.m.y H:i" }}</span>
           {% else %}
          <span>{% trans 'До конца боя' context "war_page" %}:</span><br>
          <span id='war_countdown' data-text="{% localize off %}{{ war_countdown }}{% endlocalize %}">{{ dtime_str }}</span>
            {% endif %}
        </p>

        <div class="war__gerbs">
          <p>{% trans 'Защита' context "war_page" %}:</p>
          <img src="/static/img/regions/webp/{{ war.def_region.on_map_id }}.webp">
        </div>
      </div>

      <div class="war__type">
        <svg width="34" height="34" viewBox="0 0 34 34" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M14.267 3.45443C14.2661 3.45564 14.261 3.46198 14.2502 3.47662C14.2352 3.49701 14.2148 3.52571 14.1892 3.56254C14.1383 3.63596 14.07 3.73709 13.9889 3.85915C13.8271 4.10299 13.6166 4.42689 13.3965 4.77224L13.3961 4.77279C12.836 5.64678 12.5284 6.10542 12.3796 6.27785C12.25 6.42955 12.1715 6.53168 12.1244 6.60721C12.0825 6.67435 12.0731 6.70838 12.0705 6.72615C12.0724 6.72822 12.0744 6.73043 12.0765 6.7328C12.086 6.74317 12.0972 6.75515 12.1111 6.76991C12.1903 6.85341 12.3175 6.94881 12.5609 7.07982C12.8041 7.2107 13.1488 7.36966 13.6524 7.58514C14.1454 7.79445 14.6341 8.00777 14.7405 8.05944C14.8224 8.09823 14.9361 8.1394 14.9842 8.15149C15.1146 8.17869 15.3044 8.11575 15.4414 7.93355C15.5161 7.83209 15.9564 7.15173 16.3946 6.46483C16.6122 6.12378 16.8265 5.78553 16.9901 5.52429C17.0719 5.39358 17.1407 5.28274 17.1907 5.20069C17.2355 5.12717 17.2577 5.08879 17.2644 5.0772C17.2658 5.07483 17.2665 5.07358 17.2666 5.07337L17.2666 5.07336L17.2666 5.07335L17.2682 5.06992C17.3215 4.95589 17.3206 4.90101 17.3125 4.86799C17.303 4.82947 17.2705 4.76696 17.1561 4.66402L17.1561 4.66403L17.1542 4.66228L17.1542 4.66227C17.154 4.66211 17.1514 4.65981 17.1453 4.65488C17.1393 4.65 17.1313 4.64375 17.1211 4.63604C17.1006 4.62057 17.0739 4.6011 17.0411 4.57786C16.9757 4.53144 16.8901 4.47266 16.7903 4.40542C16.5908 4.27108 16.3383 4.10554 16.0852 3.94249C15.832 3.77944 15.5794 3.61962 15.3797 3.49665C15.2797 3.43508 15.194 3.38342 15.1286 3.34543C15.0607 3.30595 15.0303 3.29056 15.0263 3.28854C15.026 3.28842 15.0259 3.28834 15.0258 3.28832C14.9794 3.27076 14.9 3.25541 14.8069 3.25115C14.7144 3.24693 14.6332 3.25478 14.5841 3.26783C14.4627 3.30281 14.3548 3.36621 14.267 3.45443Z" stroke="var(--c10one)" stroke-width="0.5"/>
          <path d="M18.4701 5.16477L18.47 5.16461C18.6249 5.13293 18.7765 5.15324 18.9022 5.21608C18.9022 5.21607 18.9024 5.21616 18.9028 5.21638C18.9049 5.21753 18.9134 5.22216 18.9314 5.23239C18.9509 5.24341 18.9771 5.25848 19.0096 5.27729C19.0744 5.31485 19.1625 5.3664 19.2676 5.42832C19.4777 5.55213 19.7548 5.71675 20.0478 5.89255L20.0489 5.89318C20.4384 6.12433 20.711 6.28945 20.8964 6.40707C21.0911 6.53062 21.1678 6.58861 21.1879 6.60876L21.1887 6.60955C21.3818 6.80093 21.4493 7.10339 21.3568 7.35967C21.3553 7.36255 21.3514 7.37016 21.3437 7.38437C21.3317 7.40652 21.3147 7.43705 21.2928 7.47553C21.2493 7.55229 21.1887 7.65728 21.1151 7.78325C20.968 8.035 20.7706 8.36822 20.5585 8.72221L19.7992 9.98689L19.5349 10.2732C19.2426 10.5897 19.1449 10.7079 18.77 11.2205L18.7696 11.2211C18.5919 11.4654 18.4307 11.6519 18.3077 11.7671C18.3025 11.7385 18.2984 11.7089 18.2956 11.6796C18.2831 11.5267 18.3085 11.3133 18.426 10.8154C18.426 10.8152 18.426 10.8151 18.4261 10.8149L18.1827 10.7575C18.3025 10.2574 18.3189 10.0977 18.2626 9.98025L18.4701 5.16477ZM18.4701 5.16477L18.461 5.16628C18.4345 5.17071 18.3542 5.19652 18.3008 5.22231L18.3009 5.22237L18.2956 5.22477C18.2368 5.25149 18.2081 5.26753 18.1801 5.29016C18.1504 5.31413 18.1108 5.35448 18.0478 5.44022C17.9176 5.61746 17.7244 5.93588 17.3454 6.56954L18.4701 5.16477ZM17.3453 6.56956C17.3453 6.56961 17.3453 6.56966 17.3453 6.56971L17.1307 6.44138C16.7479 7.08246 16.344 7.74938 16.2313 7.92315L17.3453 6.56956Z" stroke="var(--c10one)" stroke-width="0.5"/>
          <path d="M11.5089 32.6108C11.4033 32.4088 11.4197 31.8898 11.5089 31.0914C11.617 30.0981 11.9035 28.2006 12.1923 26.5639C12.6361 24.0465 12.6032 24.2579 12.568 24.1498C12.5187 24.0019 12.2768 23.645 11.6945 22.8536C10.8256 21.6794 10.5133 21.2239 10.053 20.4513C9.32738 19.2396 9.21935 19.0846 7.29845 16.5461C6.21119 15.1113 5.93644 14.6252 6.01158 14.2729C6.14779 13.613 7.33367 11.4056 8.44677 9.73131C9.48471 8.16735 10.2761 7.28674 10.7598 7.15758C10.8185 7.14114 10.8702 7.12705 10.8773 7.12705C10.8843 7.1247 10.9735 7.14584 11.0769 7.16932C12.3614 7.48164 17.4032 9.64208 17.8775 10.0859L17.9527 10.154L17.9386 10.5837C17.9198 11.1708 17.8352 11.57 17.6521 11.9387C17.53 12.1829 17.429 12.2675 17.0814 12.4084C15.9637 12.871 14.8787 13.1222 14.3245 13.0471L14.1437 13.0236L13.5261 12.4037C12.9156 11.7908 12.6291 11.5301 12.3825 11.3634C12.2933 11.3047 12.2487 11.2859 12.2299 11.3047C12.1899 11.3446 12.2064 11.5677 12.2627 11.7391C12.3074 11.873 12.3144 11.9317 12.3027 12.1007C12.2745 12.5774 11.9833 13.1716 11.6076 13.5191C11.4878 13.6295 11.4526 13.6483 11.3469 13.6624C11.2154 13.6788 11.0416 13.7398 11.0416 13.7704C11.0416 13.7798 11.0698 13.815 11.105 13.8502C11.1755 13.9207 11.354 13.977 11.7414 14.0498C12.0279 14.1038 12.1946 14.1696 12.5469 14.3692C12.716 14.4655 12.8944 14.5383 13.2655 14.6604C13.9535 14.8858 14.0686 14.9422 14.2611 15.1723C14.9539 15.9942 17.3116 19.4133 18.4505 21.2497C18.784 21.7875 18.9084 22.0152 18.9084 22.088C18.9084 22.3957 17.6262 23.3326 17.0016 23.4853C16.8396 23.5228 16.809 23.5534 16.8818 23.6121C16.91 23.6379 17.072 23.6473 17.5793 23.659C17.9433 23.6684 18.2626 23.6825 18.2932 23.6919C18.38 23.7201 18.4153 23.8234 18.4388 24.1193C18.4505 24.272 18.481 24.4856 18.5045 24.596C18.5562 24.8168 18.6454 25.3428 18.7206 25.8617C18.8333 26.6625 18.8661 27.0101 18.8732 27.5079C18.8779 27.9095 18.8873 28.0339 18.9178 28.1185C18.9859 28.2969 19.0822 29.4546 19.0704 29.9337M22.2007 32.6107C22.2172 32.3477 22.2641 32.019 22.3416 31.6292C22.3557 31.5587 22.3675 30.6335 22.3721 29.2809C22.3768 26.9842 22.3839 26.7682 22.4919 25.4884C22.5483 24.8238 22.5577 24.7721 22.6539 24.6265C22.7009 24.5561 22.816 24.4175 22.9099 24.3189C23.1306 24.0864 23.2293 23.9502 23.4524 23.5628C23.6825 23.1683 23.7177 23.1236 24.0512 22.7761C24.1991 22.6211 24.3494 22.4403 24.3846 22.3769C24.5044 22.1514 24.65 21.6231 24.8966 20.5217C25.0492 19.8337 25.0985 19.6411 25.1666 19.4533C25.3075 19.054 25.6269 17.2059 25.6645 16.5648C25.6739 16.3699 25.6692 16.2995 25.641 16.229C25.6198 16.1821 25.5917 16.1422 25.5776 16.1422C25.4954 16.1422 25.2371 16.3559 23.922 17.5159C23.1213 18.2227 22.4426 18.8169 22.4121 18.8356C22.3369 18.8873 22.2571 18.8474 22.1984 18.73C22.1256 18.5867 22.041 18.4975 21.8696 18.3871C21.7851 18.3308 21.6301 18.2063 21.5244 18.1124C21.2121 17.8259 20.6274 17.2717 20.4137 17.0556C20.0638 16.7081 19.8806 16.6118 19.2372 16.4474C18.9976 16.384 18.6665 16.2971 18.4975 16.2502C17.8611 16.0741 15.9003 15.6631 15.5597 15.6326" stroke="var(--c10one)" stroke-width="0.5"/>
          <path d="M24.4902 11.2648L24.2636 11.1591C24.3726 10.9255 24.3394 10.617 24.2002 10.4352L24.2001 10.435C24.2018 10.4374 24.1993 10.4347 24.1908 10.4257C24.1802 10.4145 24.1603 10.3935 24.1277 10.36C24.0768 10.3077 24.0062 10.236 23.9207 10.15C23.7499 9.978 23.5214 9.75013 23.2764 9.5074L23.2762 9.50725C22.9786 9.21194 22.7486 8.98841 22.585 8.83491C22.503 8.75799 22.4393 8.70022 22.393 8.66035C22.3518 8.62492 22.3356 8.61367 22.3359 8.61322C22.336 8.61305 22.3383 8.61434 22.3425 8.61642L22.3425 8.61642L22.3406 8.6155C22.164 8.52538 21.9739 8.5052 21.7913 8.55437L21.7903 8.55464C21.674 8.58541 21.5648 8.64953 21.4827 8.73162L21.3059 8.55484M24.4902 11.2648L24.2651 11.1561C24.2654 11.1554 24.2651 11.1559 24.2639 11.1579C24.2605 11.1635 24.2498 11.1808 24.2272 11.2137C24.2006 11.2525 24.1647 11.3028 24.1215 11.3615C24.0354 11.4785 23.924 11.6247 23.8081 11.7719C23.6612 11.957 23.2786 12.4407 22.8195 13.0213C22.5429 13.3711 22.2385 13.756 21.9412 14.1319L21.9412 14.1319C21.381 14.8401 21.016 15.2975 20.7801 15.585C20.662 15.729 20.5781 15.828 20.5194 15.8937C20.4771 15.941 20.4547 15.9628 20.4465 15.9709C20.4418 15.9755 20.4417 15.9756 20.4453 15.9732L20.443 15.9748L20.443 15.9748C20.1959 16.1412 19.8687 16.1444 19.6125 15.9825L19.6122 15.9823C19.5665 15.9535 19.4273 15.8833 19.2612 15.8012C19.0866 15.7149 18.8621 15.6059 18.629 15.4941L18.6285 15.4938C18.3214 15.3473 18.1077 15.2421 17.9635 15.1666C17.8913 15.1288 17.8392 15.0998 17.8026 15.0778C17.7731 15.06 17.7601 15.0504 17.7567 15.0479C17.756 15.0472 17.7552 15.0462 17.7542 15.0451C17.7508 15.0413 17.7464 15.036 17.7412 15.0293C17.7305 15.0158 17.7181 14.9986 17.7047 14.9788C17.6777 14.9386 17.6517 14.8944 17.6337 14.8586C17.5895 14.7702 17.5835 14.7523 17.58 14.7348C17.5749 14.71 17.5732 14.6752 17.5732 14.5477C17.5732 14.4279 17.5752 14.3863 17.58 14.359C17.5828 14.343 17.5867 14.3286 17.6173 14.2673L17.6185 14.2649L17.6185 14.2649C17.6168 14.2684 17.6176 14.2671 17.623 14.2586C17.6289 14.2494 17.6401 14.2317 17.6591 14.2027C17.69 14.1557 17.7334 14.0909 17.788 14.0103C17.8971 13.8493 18.0488 13.6281 18.2292 13.3666C18.5901 12.8436 19.0647 12.1611 19.5407 11.4799C20.0166 10.7987 20.4936 10.1192 20.8591 9.60238C21.042 9.34391 21.1966 9.12655 21.3092 8.97015C21.3655 8.89185 21.4108 8.82951 21.4437 8.78516C21.4621 8.76037 21.4738 8.74501 21.4804 8.73644C21.488 8.7264 21.4886 8.72565 21.4844 8.72993L21.3059 8.55484M24.4902 11.2648C24.4574 11.3329 24.239 11.6288 24.0041 11.927L21.7263 8.31297M24.4902 11.2648C24.6358 10.9524 24.5983 10.5438 24.3987 10.2832C24.3681 10.2433 23.9431 9.81588 23.4523 9.32978C22.8558 8.73801 22.5247 8.42803 22.4543 8.39281C22.2241 8.27539 21.9705 8.24722 21.7263 8.31297M21.3059 8.55484C21.4187 8.44212 21.5666 8.35524 21.7263 8.31297M21.3059 8.55484C21.1838 8.6793 17.4782 13.9817 17.3937 14.1555C17.3279 14.287 17.3232 14.3199 17.3232 14.5477C17.3232 14.7849 17.3256 14.8013 17.4101 14.9704C17.4571 15.0643 17.5369 15.1841 17.5863 15.231C17.652 15.2921 17.9056 15.4259 18.5209 15.7195L21.7263 8.31297" stroke="var(--c10one)" stroke-width="0.5"/>
          <path d="M21.0075 16.6452C21.0064 16.6477 21.0058 16.649 21.0059 16.6491C21.0063 16.6493 21.0149 16.6351 21.0412 16.599C21.0705 16.5587 21.1114 16.505 21.1615 16.4411C21.2613 16.3136 21.3934 16.1508 21.533 15.9833C21.8178 15.6443 22.7311 14.5526 23.5645 13.5526C23.9823 13.0526 24.3672 12.5938 24.6508 12.2571C24.7926 12.0887 24.9089 11.9511 24.9913 11.8543C25.0325 11.8058 25.0649 11.7678 25.0877 11.7415L25.1085 11.7176C25.11 11.7167 25.1116 11.7158 25.1134 11.7148C25.1181 11.7121 25.1228 11.7098 25.1267 11.708L21.0075 16.6452ZM21.0075 16.6452L21.0066 16.6471C20.9925 16.6775 20.9807 16.7286 20.9805 16.7876C20.9803 16.8409 20.9895 16.8785 20.9967 16.8965C20.9996 16.8998 21.011 16.9152 21.0381 16.9472C21.0722 16.9875 21.1192 17.0405 21.1758 17.1028C21.2889 17.227 21.4358 17.3831 21.5854 17.5383C21.7349 17.6935 21.8856 17.8465 22.0062 17.9647C22.0666 18.0239 22.1182 18.0732 22.1577 18.1093C22.1951 18.1435 22.2102 18.155 22.2099 18.1554C22.2099 18.1554 22.2093 18.1551 22.2082 18.1545L22.2107 18.156C22.2399 18.1742 22.2477 18.1759 22.2508 18.1766C22.2509 18.1766 22.251 18.1766 22.2512 18.1767C22.2608 18.1789 22.2817 18.1817 22.3474 18.1818C22.4326 18.1808 22.4648 18.1716 22.5059 18.1482C22.5654 18.1143 22.6468 18.0466 22.8092 17.8902C22.8773 17.8243 23.1399 17.5708 23.5138 17.2098C23.9309 16.807 24.4867 16.2704 25.0658 15.7111L25.0659 15.711L25.1505 15.6294C26.1596 14.656 26.6558 14.1773 26.9044 13.9123C27.0343 13.7737 27.0785 13.7119 27.0951 13.6808C27.0956 13.6798 27.0961 13.679 27.0965 13.6782C27.1026 13.667 27.1032 13.666 27.1088 13.6077L27.1088 13.6077C27.114 13.554 27.1085 13.5196 27.0975 13.49C27.0855 13.4578 27.0612 13.4157 27.0071 13.3549C26.9441 13.2853 26.5884 12.9179 26.2119 12.5343C25.8766 12.1943 25.7111 12.0273 25.6048 11.932C25.5122 11.849 25.4782 11.8317 25.3979 11.7925C25.2095 11.7015 25.1458 11.7038 25.1284 11.7073L21.0075 16.6452Z" stroke="var(--c10one)" stroke-width="0.5"/>
          <path d="M17.247 13.0703C17.1125 13.2282 16.9229 13.4476 16.6552 13.7572L16.6547 13.7578C16.3548 14.1068 16.0242 14.5015 15.9233 14.6319L15.9214 14.6343L15.9214 14.6344C15.8744 14.6967 15.8373 14.7423 15.8093 14.7734C15.8037 14.7715 15.7975 14.7694 15.7905 14.7669C15.7164 14.7402 15.6005 14.6871 15.4034 14.5892L17.247 13.0703ZM17.247 13.0703C17.0782 13.1156 16.8812 13.1694 16.674 13.2269L16.6071 12.9861L16.6742 13.2269C16.5871 13.2511 16.5043 13.2742 16.4256 13.2962C15.6813 13.5036 15.2998 13.6099 15.0705 13.6638C14.8179 13.7232 14.727 13.7236 14.5714 13.7243C14.5583 13.7243 14.5447 13.7244 14.5306 13.7245L14.5303 13.7245C14.4279 13.7251 14.3336 13.7248 14.2522 13.7161C14.1671 13.707 14.0799 13.6874 13.9958 13.6394C13.9119 13.5915 13.8503 13.5264 13.7985 13.4574C13.749 13.3913 13.6999 13.3096 13.647 13.2193C13.6163 13.1682 13.5845 13.1219 13.558 13.0878C13.5498 13.0772 13.5428 13.0687 13.5371 13.0622C13.5349 13.0619 13.5323 13.0615 13.5294 13.0612C13.5114 13.0595 13.4872 13.0604 13.4601 13.0656C13.4332 13.0709 13.4084 13.0794 13.3886 13.0894C13.3788 13.0944 13.3717 13.0989 13.3668 13.1026C13.3641 13.1134 13.3614 13.1295 13.3606 13.1497C13.3597 13.1724 13.3612 13.1955 13.3648 13.2158C13.3681 13.2339 13.3722 13.2454 13.3746 13.2509C13.3751 13.2511 13.3861 13.2672 13.4205 13.3015C13.4574 13.3383 13.5091 13.3841 13.5752 13.4379C13.7069 13.545 13.8839 13.6742 14.0868 13.8113C14.4928 14.0857 14.988 14.3826 15.4034 14.5891L17.247 13.0703Z" stroke="var(--c10one)" stroke-width="0.5"/>
          <circle cx="17" cy="17" r="16.5" stroke="var(--c10two)"/>
        </svg>
      </div>

      <div class="war__damage">
        <div class="war__playerDamage"></div>
        <p>
          <span>{% trans 'Урон' context "war_page" %}:</span>
          <span id="agr_dmg">{{ agr_dmg }}</span>
        </p>
        <p id="delta_dmg">
          {{ delta }}
        </p>
        <p>
          <span>{% trans 'Урон' context "war_page" %}:</span>
          <span id="def_dmg">{{ def_dmg }}</span>
        </p>
      </div>
    </div>
    
    {% if war.running %}
    {% if in_region %}
    {% if False %}
    <div class="war__prem">
      <div class="party__mmid-line"></div>

      <div class="war__prem-grid">
        <div class="war__prem-col">
          <span>{% trans 'Баланс сил' context "war_page" %}:</span>
          <label class="ct__wide-modal-label-select ct__wide-modal-label-select--100">
            <select>
              <option value="disabled" disabled selected>{% trans 'условие' context "war_page" %}</option>
              <option value="more">{% trans 'больше' context "war_page" %}</option>
              <option value="less">{% trans 'меньше' context "war_page" %}</option>
              <option value="disabled">{% trans 'не важно' context "war_page" %}</option>
            </select>
            <svg width="15" height="8" viewBox="0 0 15 8" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path d="M1 1L7.5 7L14 1" stroke="var(--c10one)"/>
            </svg>
          </label>
        </div>
        <div class="war__prem-col">
          <div class="ct__check-box30 ct__check-box30--col">
            <label>
              <input value="population" type="checkbox" name="map-layer" class="visually-hidden">
              <svg width="24" height="24" viewBox="0 0 25 25" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M24.3536 19.3536L24.5 19.2071V19V1V0.5H24H6H5.79289L5.64645 0.646447L0.646447 5.64645L0.5 5.79289V6V24V24.5H1H19H19.2071L19.3536 24.3536L24.3536 19.3536Z" stroke="var(--c10two)"/>
              </svg>
              <span>
                <svg width="24" height="24" viewBox="0 0 25 25" fill="none" xmlns="http://www.w3.org/2000/svg">
                  <path d="M24.3536 19.3536L24.5 19.2071V19V1V0.5H24H6H5.79289L5.64645 0.646447L0.646447 5.64645L0.5 5.79289V6V24V24.5H1H19H19.2071L19.3536 24.3536L24.3536 19.3536Z" stroke="var(--c10two)"/>
                  <path d="M6.5 4.5L4.5 6.5V20.5H18.5L20.5 18.5V4.5H6.5Z" fill="var(--c10two)" stroke="var(--c10two)"/>
                </svg>
              </span>
              AUTO
            </label>
          </div>
        </div>
        <div class="war__prem-col">
          <span>{% trans 'очки' context "war_page" %}:</span>
          <label>
            <input type="number">
          </label>
        </div>
      </div>
    </div>
    {% endif %}

    <div class="war__enter">
        <div class="party__mmid-line"></div>

        <div class="war__enter-grid">
            <div class="war__enter-left">
                <label class="ct__wide-modal-label-select ct__wide-modal-label-select--100">
                    <select id="war_side">
                      <option disabled selected>{% trans 'сторона боя' context "war_page" %}</option>
                      <option value="agr">{% trans 'атака' context "war_page" %}</option>
                      <option value="def">{% trans 'защита' context "war_page" %}</option>
                    </select>
                    <svg width="15" height="8" viewBox="0 0 15 8" fill="none" xmlns="http://www.w3.org/2000/svg">
                      <path d="M1 1L7.5 7L14 1" stroke="var(--c10one)"/>
                    </svg>
                </label>

                <div class="war__enter-str">
                    <span>{% trans 'Урон' context "war_page" %}:</span>
                    <span id="damage_count">0</span>
                </div>
            </div>

            <span style="text-align: center">⚡<span id="energy_count">0</span></span>

            <button class="ct__mid-btn" onclick="sendEvent()">
                <svg width="144" height="30" viewBox="0 0 144 30" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <mask id="mask0_259_319" style="mask-type:alpha" maskUnits="userSpaceOnUse" x="0" y="0" width="144" height="30">
                        <path d="M0 5.76923L5.76923 0H144V23.0769L137.077 30H0V5.76923Z" fill="var(--c10two)"/>
                    </mask>
                    <g mask="url(#mask0_259_319)">
                        <path d="M0 5.76917L5.76923 -6.10352e-05H144V23.0769L137.077 29.9999H0V5.76917Z" fill="var(--c10two)"/>
                        <path class="treg1" opacity="0.15" d="M109.266 13.4468L125.407 3.59524L125.868 22.4997L109.266 13.4468Z" fill="var(--c10one)"/>
                        <path class="treg2" opacity="0.15" d="M95.6185 -3.53072L103.36 25.3596L74.4694 17.6185L95.6185 -3.53072Z" fill="var(--c10one)"/>
                        <path class="treg3" opacity="0.15" d="M22.6079 -8.73057L72.591 7.62749L33.433 42.7351L22.6079 -8.73057Z" fill="var(--c10one)"/>
                    </g>
                </svg>
                <span>{% trans 'в бой' context "war_page" %}</span>
            </button>
        </div>
    </div>

	<div class="war__units">
		<div class="party__mmid-line"></div>

		<div class="ct__selectWithImage">
            {% for storage in storages %}
            {% if forloop.counter0 == 0 %}
			<div class="ct__selectWithImage-selected" id="default_storage" data-value="{% localize off %}{{ storage.pk }}{% endlocalize %}">
				<img id="create_default_img" src="/static/img/regions/webp/55/{{ storage.region.on_map_id }}.webp">
				<div class="ct__selectWithImage-firstText">
					<span id="create_default_region">{% trans storage.region.region_name context "regions_list" %}</span>
					<svg class="ct__selectWithImage-arrow" width="15" height="8" viewBox="0 0 15 8" fill="none" xmlns="http://www.w3.org/2000/svg">
						<path d="M1 1L7.5 7L14 1" stroke="var(--c10one)"/>
					</svg>
				</div>
			</div>
            {% endif %}
            {% endfor %}
			<div class="ct__selectWithImage-content custom-scroll custom-scroll--alt">
                {% for storage in storages %}
                <div id="create_storage_{% localize off %}{{ storage.pk }}{% endlocalize %}" {% if forloop.counter0 == 0 %}class="first_storage"{% endif %} data-value="{% localize off %}{{ storage.pk }}{% endlocalize %}">
                    <img class="offer_dummy_img" src="/static/img/regions/webp/55/{{ storage.region.on_map_id }}.webp">
                    <span class="offer_dummy_region">{% trans storage.region.region_name context "regions_list" %}</span>
                </div>
                {% endfor %}
			</div>
		</div>
        {% if units_dict %}
            {% for unit in units %}
            {% if units_dict|has_key:unit.good %}
		<div class="war__units-count">
			<span>{{ unit.good.name }}:</span>
			<label>
                <input type="number" min="0"
                                           max="{% localize off %}{{ units_dict|dict_key:unit.good }}{% endlocalize %}"
                                           step="1"
                                           id="{% localize off %}{{ unit.pk }}{% endlocalize %}"
                                           name="{% localize off %}{{ unit.pk }}{% endlocalize %}"
                                           class="unit_input" maxlength="3">
            </label>
			<span>/ {{ units_dict|dict_key:unit.good }}</span>
		</div>
            {% endif %}
            {% endfor %}
        {% else %}
            <span style="margin: auto;">{% trans 'нет войск' context "war_page" %}</span>
        {% endif %}
	</div>
    {% endif %}
    {% endif %}

    {% if graph_html %}
    <div id="graph-container" style="display: none">{{ graph_html|safe }}</div>
    {% endif %}
</section>



<script>
  function toggleActiveClass(element) {
    element.classList.toggle('active');
    if (element.classList.contains('active')) {
      element.style.height = `${element.scrollHeight + 1}px`;
    } else {
      element.style.height = '';
    }
  }
  if (screen.width >= 1200) {
    document.querySelectorAll('.war__par').forEach((el) => el.classList.add('active'));
  }

	/* создание выскакивающего сообщения */
	const messagesContainer = document.querySelector('.war__playerDamage');
	function createDamageMessage(src, points, isLeft) {
	}

	/* обратный отсчет боя */
      window.addEventListener("load", function (event) {
        if (document.getElementById("war_countdown") != undefined){

            var war_cd_elem = document.getElementById("war_countdown");

            //получает строку
            var war_cd_sec_string = $('#war_countdown').attr('data-text');
            var war_cd_sec = parseInt(war_cd_sec_string);

            if (war_cd_sec == 0) { } else {

                var war_cd_h = war_cd_sec/3600 ^ 0 ;
                var war_cd_m = (war_cd_sec-war_cd_h*3600)/60 ^ 0 ;
                var war_cd_s = war_cd_sec-war_cd_h*3600-war_cd_m*60 ;
                war_cd_elem.innerHTML = (war_cd_h<10?"0"+war_cd_h:war_cd_h)+":"+(war_cd_m<10?"0"+war_cd_m:war_cd_m)+":"+(war_cd_s<10?"0"+war_cd_s:war_cd_s);
                war_cd_sec = --war_cd_sec;


                //запускаем функцию с повторением раз 1 секунду
                var war_cd_id = setInterval(increase_frame, 1000);
                function increase_frame() {

                    var war_cd_h = war_cd_sec/3600 ^ 0 ;
                    var war_cd_m = (war_cd_sec-war_cd_h*3600)/60 ^ 0 ;
                    var war_cd_s = war_cd_sec-war_cd_h*3600-war_cd_m*60 ;
                    war_cd_elem.innerHTML = (war_cd_h<10?"0"+war_cd_h:war_cd_h)+":"+(war_cd_m<10?"0"+war_cd_m:war_cd_m)+":"+(war_cd_s<10?"0"+war_cd_s:war_cd_s);

                    if (war_cd_sec == 0) {
                        clearInterval(war_cd_id);
                    }
                    else{
                        war_cd_sec = --war_cd_sec;
                    }
                }
            }
        }
   });
</script>
{% endblock %}
