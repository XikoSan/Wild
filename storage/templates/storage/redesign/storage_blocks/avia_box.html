{% extends 'player/redesign/header.html' %}
{% load get_mul %}
{% load dict_key %}
{% load static %}
{% load get_sum %}
{% load get_mod %}
{% load l10n %}{% load i18n %}

{% block content %}
<section class="box custom-scroll">
    <!-- Заголовок -->
    <h1 class="box__title ct__page-title">Аэрокейсы</h1>


    <!-- Табы -->
    <div class="box__tabs ct__top-tabs">
        <button class="ct__top-tab ct__top-tab1 active ct__mid-btn">
            <svg width="144" height="30" viewBox="0 0 144 30" xmlns="http://www.w3.org/2000/svg">
                <mask id="mask0_259_317" style="mask-type:alpha" maskUnits="userSpaceOnUse" x="0" y="0" width="144"
                    height="30">
                    <path class="geometry1" d="M0 5.76923L5.76923 0H144V23.0769L137.077 30H0V5.76923Z" />
                </mask>
                <g mask="url(#mask0_259_317)">
                    <path class="geometry2" d="M0 5.76917L5.76923 -6.10352e-05H144V23.0769L137.077 29.9999H0V5.76917Z" />
                    <path class="treg1" opacity="0.15" d="M109.266 13.4468L125.407 3.59524L125.868 22.4997L109.266 13.4468Z"
                        fill="var(--c10one)" />
                    <path class="treg2" opacity="0.15" d="M95.6185 -3.53072L103.36 25.3596L74.4694 17.6185L95.6185 -3.53072Z"
                        fill="var(--c10one)" />
                    <path class="treg3" opacity="0.15" d="M22.6079 -8.73057L72.591 7.62749L33.433 42.7351L22.6079 -8.73057Z"
                        fill="var(--c10one)" />
                </g>
            </svg>
            <span>мои кейсы</span>
        </button>

        <button class="ct__top-tab ct__top-tab2 ct__mid-btn">
            <svg width="144" height="30" viewBox="0 0 144 30" xmlns="http://www.w3.org/2000/svg">
                <mask id="mask0_259_318" style="mask-type:alpha" maskUnits="userSpaceOnUse" x="0" y="0" width="144"
                    height="30">
                    <path class="geometry1" d="M0 5.76923L5.76923 0H144V23.0769L137.077 30H0V5.76923Z" />
                </mask>
                <g mask="url(#mask0_259_318)">
                    <path class="geometry2" d="M0 5.76917L5.76923 -6.10352e-05H144V23.0769L137.077 29.9999H0V5.76917Z" />
                    <path class="treg1" opacity="0.15" d="M109.266 13.4468L125.407 3.59524L125.868 22.4997L109.266 13.4468Z"
                        fill="var(--c10one)" />
                    <path class="treg2" opacity="0.15" d="M95.6185 -3.53072L103.36 25.3596L74.4694 17.6185L95.6185 -3.53072Z"
                        fill="var(--c10one)" />
                    <path class="treg3" opacity="0.15" d="M22.6079 -8.73057L72.591 7.62749L33.433 42.7351L22.6079 -8.73057Z"
                        fill="var(--c10one)" />
                </g>
            </svg>
            <span>приобрести</span>
        </button>
    </div>

    <!-- Блок "Мои сундуки" -->
    <div class="box__block active">
        <p class="box__desc">
            Открывайте Аэрокейсы и получайте окраски самолётов и золото!
        </p>

        <div class="box__pic">
            <img class="box__picImg" src="{% static 'img/avia_chest.png' %}" alt="">

            <button class="box__picBtn">
                <span>У вас нет Аэрокейсов</span>
                <svg width="90" height="90" viewBox="0 0 90 90" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path
                        d="M45 0C33.0653 3.35549e-05 21.6194 4.7411 13.1802 13.1802C4.7411 21.6194 3.35549e-05 33.0653 0 45C3.34951e-05 56.9347 4.7411 68.3806 13.1802 76.8198C21.6194 85.2589 33.0653 90 45 90C56.9347 90 68.3806 85.2589 76.8198 76.8198C85.2589 68.3806 90 56.9347 90 45C90 33.0653 85.2589 21.6194 76.8198 13.1802C68.3806 4.7411 56.9347 3.34951e-05 45 0ZM45 8.01812C54.8082 8.01815 64.2147 11.9145 71.1501 18.8499C78.0855 25.7853 81.9818 35.1918 81.9819 45C81.9818 54.8082 78.0855 64.2147 71.1501 71.1501C64.2147 78.0855 54.8082 81.9818 45 81.9819C35.1918 81.9818 25.7853 78.0855 18.8499 71.1501C11.9145 64.2147 8.01815 54.8082 8.01812 45C8.01815 35.1918 11.9145 25.7853 18.8499 18.8499C25.7853 11.9145 35.1918 8.01815 45 8.01812ZM44.5345 24.7951C42.5323 24.7951 40.9205 26.4069 40.9205 28.4091V40.9205H28.4091C26.4069 40.9205 24.7951 42.5323 24.7951 44.5345V45.4655C24.7951 47.4677 26.4069 49.0795 28.4091 49.0795H40.9205V61.5909C40.9205 63.5931 42.5323 65.2049 44.5345 65.2049H45.4655C47.4677 65.2049 49.0795 63.5931 49.0795 61.5909V49.0795H61.5909C63.5931 49.0795 65.2049 47.4677 65.2049 45.4655V44.5345C65.2049 42.5323 63.5931 40.9205 61.5909 40.9205H49.0795V28.4091C49.0795 26.4069 47.4677 24.7951 45.4655 24.7951H44.5345Z"
                        fill="white" />
                </svg>
                <span>приобрести</span>
            </button>

            <div class="box__picBtns">

                <p class="box__picChestCount">
                    Количество кейсов: <span class="box__picChestCount--count">0</span>
                </p>

                <button class="box__picOpen ct__mid-btn">
                    <svg width="144" height="30" viewBox="0 0 144 30" xmlns="http://www.w3.org/2000/svg">
                        <mask id="mask0_258_218" style="mask-type:alpha" maskUnits="userSpaceOnUse" x="0" y="0" width="144"
                            height="30">
                            <path class="geometry1" d="M0 5.76923L5.76923 0H144V23.0769L137.077 30H0V5.76923Z" />
                        </mask>
                        <g mask="url(#mask0_258_218)">
                            <path class="geometry2" fill="var(--c10two)"
                                d="M0 5.76917L5.76923 -6.10352e-05H144V23.0769L137.077 29.9999H0V5.76917Z" />
                            <path class="treg1" opacity="0.15"
                                d="M109.266 13.4468L125.407 3.59524L125.868 22.4997L109.266 13.4468Z" fill="var(--c10one)" />
                            <path class="treg2" opacity="0.15"
                                d="M95.6185 -3.53072L103.36 25.3596L74.4694 17.6185L95.6185 -3.53072Z" fill="var(--c10one)" />
                            <path class="treg3" opacity="0.15"
                                d="M22.6079 -8.73057L72.591 7.62749L33.433 42.7351L22.6079 -8.73057Z" fill="var(--c10one)" />
                        </g>
                    </svg>
                    <span>Открыть</span>
                </button>

                <button class="box__picOpen10 ct__mid-btn">
                    <svg width="144" height="30" viewBox="0 0 144 30" xmlns="http://www.w3.org/2000/svg">
                        <mask id="mask0_258_219" style="mask-type:alpha" maskUnits="userSpaceOnUse" x="0" y="0" width="144"
                            height="30">
                            <path class="geometry1" d="M0 5.76923L5.76923 0H144V23.0769L137.077 30H0V5.76923Z" />
                        </mask>
                        <g mask="url(#mask0_258_219)">
                            <path class="geometry2" fill="var(--c10two)"
                                d="M0 5.76917L5.76923 -6.10352e-05H144V23.0769L137.077 29.9999H0V5.76917Z" />
                            <path class="treg1" opacity="0.15"
                                d="M109.266 13.4468L125.407 3.59524L125.868 22.4997L109.266 13.4468Z" fill="var(--c10one)" />
                            <path class="treg2" opacity="0.15"
                                d="M95.6185 -3.53072L103.36 25.3596L74.4694 17.6185L95.6185 -3.53072Z" fill="var(--c10one)" />
                            <path class="treg3" opacity="0.15"
                                d="M22.6079 -8.73057L72.591 7.62749L33.433 42.7351L22.6079 -8.73057Z" fill="var(--c10one)" />
                        </g>
                    </svg>
                    <span>Открыть х3</span>
                </button>

                <p class="box__picChestCount box__garantCount">
                    До гаранта: <span class="box__picChestCount--count box__garantCount--count">10</span>
                </p>
            </div>
        </div>

        <p class="box__desc">
            В этом кейсе вы можете найти:
        </p>

        <ul class="box__altList">
            <li class="box__altItem">
                <div class="box__altItemLeft">
                    <span>шанс</span>
                    <span>1%</span>
                </div>
                <div class="box__altItemRight">
                    <h3>Уникальные самолёты</h3>
                    <div class="box__altItemGrid">
                        {% for plane in epic_slice %}
                        <img src="/static/img/planes/{{ plane.0 }}/{{ plane.0 }}_{{ plane.1 }}.svg" alt="{{ plane.0 }}_{{ plane.1 }}">
                        {% endfor %}
                        <button id='flyModalOpen1'>
                            <svg clip-rule="evenodd" fill-rule="evenodd" stroke-linejoin="round" stroke-miterlimit="2"
                                viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                                <path
                                    d="m3.3 15.4c.717 0 1.3.583 1.3 1.3s-.583 1.3-1.3 1.3-1.3-.583-1.3-1.3.583-1.3 1.3-1.3zm2.7 1.85c0-.414.336-.75.75-.75h14.5c.414 0 .75.336.75.75s-.336.75-.75.75h-14.5c-.414 0-.75-.336-.75-.75zm-2.7-6.55c.717 0 1.3.583 1.3 1.3s-.583 1.3-1.3 1.3-1.3-.583-1.3-1.3.583-1.3 1.3-1.3zm2.7 1.3c0-.414.336-.75.75-.75h14.5c.414 0 .75.336.75.75s-.336.75-.75.75h-14.5c-.414 0-.75-.336-.75-.75zm-2.7-6c.717 0 1.3.583 1.3 1.3s-.583 1.3-1.3 1.3-1.3-.583-1.3-1.3.583-1.3 1.3-1.3zm2.7.75c0-.414.336-.75.75-.75h14.5c.414 0 .75.336.75.75s-.336.75-.75.75h-14.5c-.414 0-.75-.336-.75-.75z"
                                    fill-rule="nonzero" />
                            </svg>
                        </button>
                    </div>
                </div>
            </li>

            <li class="box__altItem">
                <div class="box__altItemLeft">
                    <span>шанс</span>
                    <span>11%</span>
                </div>
                <div class="box__altItemRight">
                    <h3>Особые самолёты</h3>
                    <div class="box__altItemGrid">
                        {% for plane in rare_slice %}
                        <img src="/static/img/planes/{{ plane.0 }}/{{ plane.0 }}_{{ plane.1 }}.svg" alt="{{ plane.0 }}_{{ plane.1 }}">
                        {% endfor %}
                        <button id='flyModalOpen2'>
                            <svg clip-rule="evenodd" fill-rule="evenodd" stroke-linejoin="round" stroke-miterlimit="2"
                                viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                                <path
                                    d="m3.3 15.4c.717 0 1.3.583 1.3 1.3s-.583 1.3-1.3 1.3-1.3-.583-1.3-1.3.583-1.3 1.3-1.3zm2.7 1.85c0-.414.336-.75.75-.75h14.5c.414 0 .75.336.75.75s-.336.75-.75.75h-14.5c-.414 0-.75-.336-.75-.75zm-2.7-6.55c.717 0 1.3.583 1.3 1.3s-.583 1.3-1.3 1.3-1.3-.583-1.3-1.3.583-1.3 1.3-1.3zm2.7 1.3c0-.414.336-.75.75-.75h14.5c.414 0 .75.336.75.75s-.336.75-.75.75h-14.5c-.414 0-.75-.336-.75-.75zm-2.7-6c.717 0 1.3.583 1.3 1.3s-.583 1.3-1.3 1.3-1.3-.583-1.3-1.3.583-1.3 1.3-1.3zm2.7.75c0-.414.336-.75.75-.75h14.5c.414 0 .75.336.75.75s-.336.75-.75.75h-14.5c-.414 0-.75-.336-.75-.75z"
                                    fill-rule="nonzero" />
                            </svg>
                        </button>
                    </div>
                </div>
            </li>

            <li class="box__altItem">
                <div class="box__altItemLeft">
                    <span>шанс</span>
                    <span>55%</span>
                </div>
                <div class="box__altItemRight">
                    <h3>Обычные самолёты</h3>
                    <div class="box__altItemGrid">
                        {% for plane in common_slice %}
                        <img src="/static/img/planes/{{ plane.0 }}/{{ plane.0 }}_{{ plane.1 }}.svg" alt="{{ plane.0 }}_{{ plane.1 }}">
                        {% endfor %}
                        <button id='flyModalOpen3'>
                            <svg clip-rule="evenodd" fill-rule="evenodd" stroke-linejoin="round" stroke-miterlimit="2"
                                viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                                <path
                                    d="m3.3 15.4c.717 0 1.3.583 1.3 1.3s-.583 1.3-1.3 1.3-1.3-.583-1.3-1.3.583-1.3 1.3-1.3zm2.7 1.85c0-.414.336-.75.75-.75h14.5c.414 0 .75.336.75.75s-.336.75-.75.75h-14.5c-.414 0-.75-.336-.75-.75zm-2.7-6.55c.717 0 1.3.583 1.3 1.3s-.583 1.3-1.3 1.3-1.3-.583-1.3-1.3.583-1.3 1.3-1.3zm2.7 1.3c0-.414.336-.75.75-.75h14.5c.414 0 .75.336.75.75s-.336.75-.75.75h-14.5c-.414 0-.75-.336-.75-.75zm-2.7-6c.717 0 1.3.583 1.3 1.3s-.583 1.3-1.3 1.3-1.3-.583-1.3-1.3.583-1.3 1.3-1.3zm2.7.75c0-.414.336-.75.75-.75h14.5c.414 0 .75.336.75.75s-.336.75-.75.75h-14.5c-.414 0-.75-.336-.75-.75z"
                                    fill-rule="nonzero" />
                            </svg>
                        </button>
                    </div>
                </div>
            </li>

            <li class="box__altItem">
                <div class="box__altItemLeft">
                    <span>шанс</span>
                    <span>33%</span>
                </div>
                <div class="box__altItemRight">
                    <h3>Игровое золото</h3>
                    <div class="box__altItemGrid">
                        <img class="carImg" src="/static/redesign/img/events/gold.svg" alt="gold">
                        <span>1k</span>
                        <span>3k</span>
                        <span>100k</span>
                    </div>
                </div>
            </li>
        </ul>
    </div>
    <!-- КОНЕЦ: Блок "Мои сундуки" -->


    <!-- Блок "Приобрести" -->
    <div class="box__block">
        <p class="box__desc">
            Приобретите наборы Аэрокейсов с приятной выгодой!
        </p>

        <ul class="box__buyList">
            <li class="box__buyItem">
                <img src="{% static 'img/avia_chest.png' %}" alt="">
                <span>x1</span>
                <div class="box__buyBtnBlock">
                    <button class="ct__mid-btn" onclick="buy_lootbox(1)">
                        <svg width="144" height="30" viewBox="0 0 144 30" xmlns="http://www.w3.org/2000/svg">
                            <mask id="mask0_59_315" style="mask-type:alpha" maskUnits="userSpaceOnUse" x="0" y="0" width="144"
                                height="30">
                                <path class="geometry1" d="M0 5.76923L5.76923 0H144V23.0769L137.077 30H0V5.76923Z" />
                            </mask>
                            <g mask="url(#mask0_59_315)">
                                <path class="geometry2" fill="var(--c10two)"
                                    d="M0 5.76917L5.76923 -6.10352e-05H144V23.0769L137.077 29.9999H0V5.76917Z" />
                                <path class="treg1" opacity="0.15"
                                    d="M109.266 13.4468L125.407 3.59524L125.868 22.4997L109.266 13.4468Z" fill="var(--c10one)" />
                                <path class="treg2" opacity="0.15"
                                    d="M95.6185 -3.53072L103.36 25.3596L74.4694 17.6185L95.6185 -3.53072Z" fill="var(--c10one)" />
                                <path class="treg3" opacity="0.15"
                                    d="M22.6079 -8.73057L72.591 7.62749L33.433 42.7351L22.6079 -8.73057Z" fill="var(--c10one)" />
                            </g>
                        </svg>
                        <span>1000 G</span>
                    </button>
                </div>
            </li>

            <li class="box__buyItem">
                <img src="{% static 'img/avia_chest.png' %}" alt="">
                <span>x5</span>
                <div class="box__buyBtnBlock">
                    <button class="ct__mid-btn" onclick="buy_lootbox(5)">
                        <svg width="144" height="30" viewBox="0 0 144 30" xmlns="http://www.w3.org/2000/svg">
                            <mask id="mask0_59_316" style="mask-type:alpha" maskUnits="userSpaceOnUse" x="0" y="0" width="144"
                                height="30">
                                <path class="geometry1" d="M0 5.76923L5.76923 0H144V23.0769L137.077 30H0V5.76923Z" />
                            </mask>
                            <g mask="url(#mask0_59_316)">
                                <path class="geometry2" fill="var(--c10two)"
                                    d="M0 5.76917L5.76923 -6.10352e-05H144V23.0769L137.077 29.9999H0V5.76917Z" />
                                <path class="treg1" opacity="0.15"
                                    d="M109.266 13.4468L125.407 3.59524L125.868 22.4997L109.266 13.4468Z" fill="var(--c10one)" />
                                <path class="treg2" opacity="0.15"
                                    d="M95.6185 -3.53072L103.36 25.3596L74.4694 17.6185L95.6185 -3.53072Z" fill="var(--c10one)" />
                                <path class="treg3" opacity="0.15"
                                    d="M22.6079 -8.73057L72.591 7.62749L33.433 42.7351L22.6079 -8.73057Z" fill="var(--c10one)" />
                            </g>
                        </svg>
                        <span>4500 G</span>
                    </button>
                    <p class="box__sale">скидка: <span>G 500</span></p>
                </div>
            </li>

            <li class="box__buyItem">
                <img src="{% static 'img/avia_chest.png' %}" alt="">
                <span>x10</span>
                <div class="box__buyBtnBlock">
                    <button class="ct__mid-btn" onclick="buy_lootbox(10)">
                        <svg width="144" height="30" viewBox="0 0 144 30" xmlns="http://www.w3.org/2000/svg">
                            <mask id="mask0_59_317" style="mask-type:alpha" maskUnits="userSpaceOnUse" x="0" y="0" width="144"
                                height="30">
                                <path class="geometry1" d="M0 5.76923L5.76923 0H144V23.0769L137.077 30H0V5.76923Z" />
                            </mask>
                            <g mask="url(#mask0_59_317)">
                                <path class="geometry2" fill="var(--c10two)"
                                    d="M0 5.76917L5.76923 -6.10352e-05H144V23.0769L137.077 29.9999H0V5.76917Z" />
                                <path class="treg1" opacity="0.15"
                                    d="M109.266 13.4468L125.407 3.59524L125.868 22.4997L109.266 13.4468Z" fill="var(--c10one)" />
                                <path class="treg2" opacity="0.15"
                                    d="M95.6185 -3.53072L103.36 25.3596L74.4694 17.6185L95.6185 -3.53072Z" fill="var(--c10one)" />
                                <path class="treg3" opacity="0.15"
                                    d="M22.6079 -8.73057L72.591 7.62749L33.433 42.7351L22.6079 -8.73057Z" fill="var(--c10one)" />
                            </g>
                        </svg>
                        <span>8500 G</span>
                    </button>
                    <p class="box__sale">скидка: <span>G 1500</span></p>
                </div>
            </li>

            <li class="box__buyItem">
                <img src="{% static 'img/avia_chest.png' %}" alt="">
                <span>x50</span>
                <div class="box__buyBtnBlock">
                    <button class="ct__mid-btn" onclick="buy_lootbox(50)">
                        <svg width="144" height="30" viewBox="0 0 144 30" xmlns="http://www.w3.org/2000/svg">
                            <mask id="mask0_59_318" style="mask-type:alpha" maskUnits="userSpaceOnUse" x="0" y="0" width="144"
                                height="30">
                                <path class="geometry1" d="M0 5.76923L5.76923 0H144V23.0769L137.077 30H0V5.76923Z" />
                            </mask>
                            <g mask="url(#mask0_59_318)">
                                <path class="geometry2" fill="var(--c10two)"
                                    d="M0 5.76917L5.76923 -6.10352e-05H144V23.0769L137.077 29.9999H0V5.76917Z" />
                                <path class="treg1" opacity="0.15"
                                    d="M109.266 13.4468L125.407 3.59524L125.868 22.4997L109.266 13.4468Z" fill="var(--c10one)" />
                                <path class="treg2" opacity="0.15"
                                    d="M95.6185 -3.53072L103.36 25.3596L74.4694 17.6185L95.6185 -3.53072Z" fill="var(--c10one)" />
                                <path class="treg3" opacity="0.15"
                                    d="M22.6079 -8.73057L72.591 7.62749L33.433 42.7351L22.6079 -8.73057Z" fill="var(--c10one)" />
                            </g>
                        </svg>
                        <span>45 000 G</span>
                    </button>
                    <p class="box__sale">скидка: <span>G 5 000</span></p>
                </div>
            </li>

            <li class="box__buyItem">
                <img src="{% static 'img/avia_chest.png' %}" alt="">
                <span>x100</span>
                <div class="box__buyBtnBlock">
                    <button class="ct__mid-btn" onclick="buy_lootbox(100)">
                        <svg width="144" height="30" viewBox="0 0 144 30" xmlns="http://www.w3.org/2000/svg">
                            <mask id="mask0_59_319" style="mask-type:alpha" maskUnits="userSpaceOnUse" x="0" y="0" width="144"
                                height="30">
                                <path class="geometry1" d="M0 5.76923L5.76923 0H144V23.0769L137.077 30H0V5.76923Z" />
                            </mask>
                            <g mask="url(#mask0_59_319)">
                                <path class="geometry2" fill="var(--c10two)"
                                    d="M0 5.76917L5.76923 -6.10352e-05H144V23.0769L137.077 29.9999H0V5.76917Z" />
                                <path class="treg1" opacity="0.15"
                                    d="M109.266 13.4468L125.407 3.59524L125.868 22.4997L109.266 13.4468Z" fill="var(--c10one)" />
                                <path class="treg2" opacity="0.15"
                                    d="M95.6185 -3.53072L103.36 25.3596L74.4694 17.6185L95.6185 -3.53072Z" fill="var(--c10one)" />
                                <path class="treg3" opacity="0.15"
                                    d="M22.6079 -8.73057L72.591 7.62749L33.433 42.7351L22.6079 -8.73057Z" fill="var(--c10one)" />
                            </g>
                        </svg>
                        <span>85 000 G</span>
                    </button>
                    <p class="box__sale">скидка: <span>G 15 000</span></p>
                </div>
            </li>
        </ul>
    </div>
    <!-- КОНЕЦ: Блок "Приобрести" -->


    <!-- Модалка с лутом 1на рулетка-->
    <div class="box__modal custom-scroll box__modal1">
        <button class="box__close box__close1" onclick="loot_aviaboxes()">
            <svg width="32" height="32" viewBox="0 0 32 32" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M1 1L31 31M31 1L1.53571 30.4643" stroke-width="1" stroke="var(--c10one)" />
            </svg>
        </button>

        <h3 class="box__subTitle">
            Открываем кейс...
        </h3>

        <div id='carousel1'>
            <div class='carListContainerDiv'>
                <div class=' carListContainer'>
                    <ul class='carList'>
                        {% for plane in common_list %}
                        <li class='carItem'>
                            <img class="carImg" src="/static/img/planes/{{ plane.0 }}/{{ plane.0 }}_{{ plane.1 }}.svg" alt="{{ plane.0 }}_{{ plane.1 }}">
                        </li>
                        {% endfor %}
                        {% for plane in rare_list %}
                        <li class='carItem'>
                            <img class="carImg" src="/static/img/planes/{{ plane.0 }}/{{ plane.0 }}_{{ plane.1 }}.svg" alt="{{ plane.0 }}_{{ plane.1 }}">
                        </li>
                        {% endfor %}
                        {% for plane in epic_list %}
                        <li class='carItem'>
                            <img class="carImg" src="/static/img/planes/{{ plane.0 }}/{{ plane.0 }}_{{ plane.1 }}.svg" alt="{{ plane.0 }}_{{ plane.1 }}">
                        </li>
                        {% endfor %}
                        <li class='carItem'>
                            <img class="carImg" src="/static/redesign/img/events/gold_500.svg" alt="gold_500">
                        </li>
                        <li class='carItem'>
                            <img class="carImg" src="/static/redesign/img/events/gold_1000.svg" alt="gold_1000">
                        </li>
                        <li class='carItem'>
                            <img class="carImg" src="/static/redesign/img/events/gold_3000.svg" alt="gold_3000">
                        </li>
                        <li class='carItem'>
                            <img class="carImg" src="/static/redesign/img/events/gold_5000.svg" alt="gold_5000">
                        </li>
                        <li class='carItem'>
                            <img class="carImg" src="/static/redesign/img/events/gold_100000.svg" alt="gold_100000">
                        </li>

                        {% if variants|get_mod:2 == 1  %}
                        <li class='carItem'>
                            <img class="carImg" src="/static/redesign/img/events/gold_100000.svg" alt="gold_100000">
                        </li>
                        {% endif %}
                    </ul>
                </div>
            </div>

            <div class="box__modal1info box__modalInfo">
                <p class='box__modalDesc'><span id="prize_name"></span><span id="prize_rarity"></span></p>

                <div class="box__modalBtns">
                    <button class="box__picOpen ct__mid-btn" id='modal__restart1'>
                        <svg width="144" height="30" viewBox="0 0 144 30" xmlns="http://www.w3.org/2000/svg">
                            <mask id="mask0_258_233" style="mask-type:alpha" maskUnits="userSpaceOnUse" x="0" y="0" width="144"
                                height="30">
                                <path class="geometry1" d="M0 5.76923L5.76923 0H144V23.0769L137.077 30H0V5.76923Z" />
                            </mask>
                            <g mask="url(#mask0_258_233)">
                                <path class="geometry2" fill="var(--c10two)"
                                    d="M0 5.76917L5.76923 -6.10352e-05H144V23.0769L137.077 29.9999H0V5.76917Z" />
                                <path class="treg1" opacity="0.15"
                                    d="M109.266 13.4468L125.407 3.59524L125.868 22.4997L109.266 13.4468Z" fill="var(--c10one)" />
                                <path class="treg2" opacity="0.15"
                                    d="M95.6185 -3.53072L103.36 25.3596L74.4694 17.6185L95.6185 -3.53072Z" fill="var(--c10one)" />
                                <path class="treg3" opacity="0.15"
                                    d="M22.6079 -8.73057L72.591 7.62749L33.433 42.7351L22.6079 -8.73057Z" fill="var(--c10one)" />
                            </g>
                        </svg>
                        <span>Рестарт: 500 G</span>
                    </button>

                    <button class="box__picOpen ct__mid-btn" id='modal__continue1' onclick="loot_aviaboxes()">
                        <svg width="144" height="30" viewBox="0 0 144 30" xmlns="http://www.w3.org/2000/svg">
                            <mask id="mask0_258_234" style="mask-type:alpha" maskUnits="userSpaceOnUse" x="0" y="0" width="144"
                                height="30">
                                <path class="geometry1" d="M0 5.76923L5.76923 0H144V23.0769L137.077 30H0V5.76923Z" />
                            </mask>
                            <g mask="url(#mask0_258_234)">
                                <path class="geometry2" fill="var(--c10two)"
                                    d="M0 5.76917L5.76923 -6.10352e-05H144V23.0769L137.077 29.9999H0V5.76917Z" />
                                <path class="treg1" opacity="0.15"
                                    d="M109.266 13.4468L125.407 3.59524L125.868 22.4997L109.266 13.4468Z" fill="var(--c10one)" />
                                <path class="treg2" opacity="0.15"
                                    d="M95.6185 -3.53072L103.36 25.3596L74.4694 17.6185L95.6185 -3.53072Z" fill="var(--c10one)" />
                                <path class="treg3" opacity="0.15"
                                    d="M22.6079 -8.73057L72.591 7.62749L33.433 42.7351L22.6079 -8.73057Z" fill="var(--c10one)" />
                            </g>
                        </svg>
                        <span>Продолжить</span>
                    </button>
                </div>
            </div>
        </div>

    </div>
    <!-- КОНЕЦ: Модалка с лутом 1на рулетка -->


    <!-- Модалка с лутом 3 рулетки-->
    <div class="box__modal box__modal--3 custom-scroll box__modal3">
        <button class="box__close box__close3"  onclick="loot_aviaboxes()">
            <svg width="32" height="32" viewBox="0 0 32 32" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M1 1L31 31M31 1L1.53571 30.4643" stroke-width="1" stroke="var(--c10one)" />
            </svg>
        </button>

        <h3 class="box__subTitle">
            Открываем кейсы...
        </h3>

        <div class="box__3carouselWrapper">
            <div id='carousel2'>
                <div class='carListContainerDiv'>
                    <div class=' carListContainer'>
                        <ul class='carList'>
                            {% for plane in common_list %}
                            <li class='carItem'>
                                <img class="carImg" src="/static/img/planes/{{ plane.0 }}/{{ plane.0 }}_{{ plane.1 }}.svg" alt="{{ plane.0 }}_{{ plane.1 }}">
                            </li>
                            {% endfor %}
                            {% for plane in rare_list %}
                            <li class='carItem'>
                                <img class="carImg" src="/static/img/planes/{{ plane.0 }}/{{ plane.0 }}_{{ plane.1 }}.svg" alt="{{ plane.0 }}_{{ plane.1 }}">
                            </li>
                            {% endfor %}
                            {% for plane in epic_list %}
                            <li class='carItem'>
                                <img class="carImg" src="/static/img/planes/{{ plane.0 }}/{{ plane.0 }}_{{ plane.1 }}.svg" alt="{{ plane.0 }}_{{ plane.1 }}">
                            </li>
                            {% endfor %}
                            <li class='carItem'>
                                <img class="carImg" src="/static/redesign/img/events/gold_500.svg" alt="gold_500">
                            </li>
                            <li class='carItem'>
                                <img class="carImg" src="/static/redesign/img/events/gold_1000.svg" alt="gold_1000">
                            </li>
                            <li class='carItem'>
                                <img class="carImg" src="/static/redesign/img/events/gold_3000.svg" alt="gold_3000">
                            </li>
                            <li class='carItem'>
                                <img class="carImg" src="/static/redesign/img/events/gold_5000.svg" alt="gold_5000">
                            </li>
                            <li class='carItem'>
                                <img class="carImg" src="/static/redesign/img/events/gold_100000.svg" alt="gold_100000">
                            </li>

                            {% if variants|get_mod:2 == 1  %}
                            <li class='carItem'>
                                <img class="carImg" src="/static/redesign/img/events/gold_100000.svg" alt="gold_100000">
                            </li>
                            {% endif %}
                        </ul>
                    </div>
                </div>
            </div>

            <div id='carousel3'>
                <div class='carListContainerDiv'>
                    <div class=' carListContainer'>
                        <ul class='carList'>
                            {% for plane in common_list %}
                            <li class='carItem'>
                                <img class="carImg" src="/static/img/planes/{{ plane.0 }}/{{ plane.0 }}_{{ plane.1 }}.svg" alt="{{ plane.0 }}_{{ plane.1 }}">
                            </li>
                            {% endfor %}
                            {% for plane in rare_list %}
                            <li class='carItem'>
                                <img class="carImg" src="/static/img/planes/{{ plane.0 }}/{{ plane.0 }}_{{ plane.1 }}.svg" alt="{{ plane.0 }}_{{ plane.1 }}">
                            </li>
                            {% endfor %}
                            {% for plane in epic_list %}
                            <li class='carItem'>
                                <img class="carImg" src="/static/img/planes/{{ plane.0 }}/{{ plane.0 }}_{{ plane.1 }}.svg" alt="{{ plane.0 }}_{{ plane.1 }}">
                            </li>
                            {% endfor %}
                            <li class='carItem'>
                                <img class="carImg" src="/static/redesign/img/events/gold_500.svg" alt="gold_500">
                            </li>
                            <li class='carItem'>
                                <img class="carImg" src="/static/redesign/img/events/gold_1000.svg" alt="gold_1000">
                            </li>
                            <li class='carItem'>
                                <img class="carImg" src="/static/redesign/img/events/gold_3000.svg" alt="gold_3000">
                            </li>
                            <li class='carItem'>
                                <img class="carImg" src="/static/redesign/img/events/gold_5000.svg" alt="gold_5000">
                            </li>
                            <li class='carItem'>
                                <img class="carImg" src="/static/redesign/img/events/gold_100000.svg" alt="gold_100000">
                            </li>

                            {% if variants|get_mod:2 == 1  %}
                            <li class='carItem'>
                                <img class="carImg" src="/static/redesign/img/events/gold_100000.svg" alt="gold_100000">
                            </li>
                            {% endif %}
                        </ul>
                    </div>
                </div>
            </div>

            <div id='carousel4'>
                <div class='carListContainerDiv'>
                    <div class=' carListContainer'>
                        <ul class='carList'>
                            {% for plane in common_list %}
                            <li class='carItem'>
                                <img class="carImg" src="/static/img/planes/{{ plane.0 }}/{{ plane.0 }}_{{ plane.1 }}.svg" alt="{{ plane.0 }}_{{ plane.1 }}">
                            </li>
                            {% endfor %}
                            {% for plane in rare_list %}
                            <li class='carItem'>
                                <img class="carImg" src="/static/img/planes/{{ plane.0 }}/{{ plane.0 }}_{{ plane.1 }}.svg" alt="{{ plane.0 }}_{{ plane.1 }}">
                            </li>
                            {% endfor %}
                            {% for plane in epic_list %}
                            <li class='carItem'>
                                <img class="carImg" src="/static/img/planes/{{ plane.0 }}/{{ plane.0 }}_{{ plane.1 }}.svg" alt="{{ plane.0 }}_{{ plane.1 }}">
                            </li>
                            {% endfor %}
                            <li class='carItem'>
                                <img class="carImg" src="/static/redesign/img/events/gold_500.svg" alt="gold_500">
                            </li>
                            <li class='carItem'>
                                <img class="carImg" src="/static/redesign/img/events/gold_1000.svg" alt="gold_1000">
                            </li>
                            <li class='carItem'>
                                <img class="carImg" src="/static/redesign/img/events/gold_3000.svg" alt="gold_3000">
                            </li>
                            <li class='carItem'>
                                <img class="carImg" src="/static/redesign/img/events/gold_5000.svg" alt="gold_5000">
                            </li>
                            <li class='carItem'>
                                <img class="carImg" src="/static/redesign/img/events/gold_100000.svg" alt="gold_100000">
                            </li>

                            {% if variants|get_mod:2 == 1  %}
                            <li class='carItem'>
                                <img class="carImg" src="/static/redesign/img/events/gold_100000.svg" alt="gold_100000">
                            </li>
                            {% endif %}
                        </ul>
                    </div>
                </div>

                <div class="box__modal3info box__modalInfo">
                    <div class="box__modalBtns">
<!--                        <button class="box__picOpen ct__mid-btn" id='modal__restart3'>-->
<!--                            <svg width="144" height="30" viewBox="0 0 144 30" xmlns="http://www.w3.org/2000/svg">-->
<!--                                <mask id="mask0_258_2331" style="mask-type:alpha" maskUnits="userSpaceOnUse" x="0" y="0" width="144"-->
<!--                                    height="30">-->
<!--                                    <path class="geometry1" d="M0 5.76923L5.76923 0H144V23.0769L137.077 30H0V5.76923Z" />-->
<!--                                </mask>-->
<!--                                <g mask="url(#mask0_258_2331)">-->
<!--                                    <path class="geometry2" fill="var(&#45;&#45;c10two)"-->
<!--                                        d="M0 5.76917L5.76923 -6.10352e-05H144V23.0769L137.077 29.9999H0V5.76917Z" />-->
<!--                                    <path class="treg1" opacity="0.15"-->
<!--                                        d="M109.266 13.4468L125.407 3.59524L125.868 22.4997L109.266 13.4468Z" fill="var(&#45;&#45;c10one)" />-->
<!--                                    <path class="treg2" opacity="0.15"-->
<!--                                        d="M95.6185 -3.53072L103.36 25.3596L74.4694 17.6185L95.6185 -3.53072Z" fill="var(&#45;&#45;c10one)" />-->
<!--                                    <path class="treg3" opacity="0.15"-->
<!--                                        d="M22.6079 -8.73057L72.591 7.62749L33.433 42.7351L22.6079 -8.73057Z" fill="var(&#45;&#45;c10one)" />-->
<!--                                </g>-->
<!--                            </svg>-->
<!--                            <span>Рестарт: 1500 G</span>-->
<!--                        </button>-->

                        <button class="box__picOpen ct__mid-btn" id='modal__continue3' onclick="loot_aviaboxes()">
                            <svg width="144" height="30" viewBox="0 0 144 30" xmlns="http://www.w3.org/2000/svg">
                                <mask id="mask0_258_2341" style="mask-type:alpha" maskUnits="userSpaceOnUse" x="0" y="0" width="144"
                                    height="30">
                                    <path class="geometry1" d="M0 5.76923L5.76923 0H144V23.0769L137.077 30H0V5.76923Z" />
                                </mask>
                                <g mask="url(#mask0_258_2341)">
                                    <path class="geometry2" fill="var(--c10two)"
                                        d="M0 5.76917L5.76923 -6.10352e-05H144V23.0769L137.077 29.9999H0V5.76917Z" />
                                    <path class="treg1" opacity="0.15"
                                        d="M109.266 13.4468L125.407 3.59524L125.868 22.4997L109.266 13.4468Z" fill="var(--c10one)" />
                                    <path class="treg2" opacity="0.15"
                                        d="M95.6185 -3.53072L103.36 25.3596L74.4694 17.6185L95.6185 -3.53072Z" fill="var(--c10one)" />
                                    <path class="treg3" opacity="0.15"
                                        d="M22.6079 -8.73057L72.591 7.62749L33.433 42.7351L22.6079 -8.73057Z" fill="var(--c10one)" />
                                </g>
                            </svg>
                            <span>Продолжить</span>
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- КОНЕЦ: Модалка с лутом 3 рулетки -->

    <div class="box__modal box__modal--noCenter custom-scroll" id='flyModal1'>
        <button class="box__close">
            <svg width="32" height="32" viewBox="0 0 32 32" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M1 1L31 31M31 1L1.53571 30.4643" stroke-width="1" stroke="var(--c10one)" />
            </svg>
        </button>

        <h1 class="box__title ct__page-title">Уникальные самолёты</h1>

        <div class="box__modalGrid">
            {% for plane in epic_list %}
            {% if plane.2 %}
            <div class="profile__top-left">
                <img src="/static/redesign/img/events/gold_5000.svg" class="profile__ava-border">
                <img src="/static/img/planes/{{ plane.0 }}/{{ plane.0 }}_{{ plane.1 }}.svg" alt="{{ plane.0 }}_{{ plane.1 }}" style="opacity: 0.5;">
            </div>
            {% else %}
            <img src="/static/img/planes/{{ plane.0 }}/{{ plane.0 }}_{{ plane.1 }}.svg" alt="{{ plane.0 }}_{{ plane.1 }}">
            {% endif %}
            {% endfor %}
        </div>
    </div>

    <div class="box__modal box__modal--noCenter custom-scroll" id='flyModal2'>
        <button class="box__close">
            <svg width="32" height="32" viewBox="0 0 32 32" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M1 1L31 31M31 1L1.53571 30.4643" stroke-width="1" stroke="var(--c10one)" />
            </svg>
        </button>

        <h1 class="box__title ct__page-title">Особые самолёты</h1>

        <div class="box__modalGrid">
            {% for plane in rare_list %}
            {% if plane.2 %}
            <div class="profile__top-left">
                <img src="/static/redesign/img/events/gold_1000.svg" class="profile__ava-border">
                <img src="/static/img/planes/{{ plane.0 }}/{{ plane.0 }}_{{ plane.1 }}.svg" alt="{{ plane.0 }}_{{ plane.1 }}" style="opacity: 0.5;">
            </div>
            {% else %}
            <img src="/static/img/planes/{{ plane.0 }}/{{ plane.0 }}_{{ plane.1 }}.svg" alt="{{ plane.0 }}_{{ plane.1 }}">
            {% endif %}
            {% endfor %}
        </div>
    </div>

    <div class="box__modal box__modal--noCenter custom-scroll" id='flyModal3'>
        <button class="box__close">
            <svg width="32" height="32" viewBox="0 0 32 32" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M1 1L31 31M31 1L1.53571 30.4643" stroke-width="1" stroke="var(--c10one)" />
            </svg>
        </button>

        <h1 class="box__title ct__page-title">Обычные самолёты</h1>

        <div class="box__modalGrid">
            {% for plane in common_list %}
                {% if not plane.0 == 'beluzzo' %}
            {% if plane.2 %}
            <div class="profile__top-left">
                <img src="/static/redesign/img/events/gold_500.svg" class="profile__ava-border">
                <img src="/static/img/planes/{{ plane.0 }}/{{ plane.0 }}_{{ plane.1 }}.svg" alt="{{ plane.0 }}_{{ plane.1 }}" style="opacity: 0.5;">
            </div>
            {% else %}
            <img src="/static/img/planes/{{ plane.0 }}/{{ plane.0 }}_{{ plane.1 }}.svg" alt="{{ plane.0 }}_{{ plane.1 }}">
            {% endif %}
                {% endif %}
            {% endfor %}
        </div>
    </div>

    <div class="wp-loader-wrapper">
        <span class="wp-loader"></span>
    </div>

</section>
{% endblock %}

{% block for_scripts_and_css %}


<script>
        // сундуки - лут
        function loot_aviaboxes(){
            var sending_data = "&csrfmiddlewaretoken=" + csrftoken;
            $.ajax({
                type: "POST",
                url: "/loot_aviaboxes/",
                data:  sending_data,
                cache: false,
                success: function(data){
                    if (data.response == 'ok'){
                    }
                    else{
                        display_modal('notify', data.header, data.response, null, data.grey_btn);
                    }
                }
            });
        };

        // сундуки - использование
        function buy_lootbox(count){
            var sending_data = "&csrfmiddlewaretoken=" + csrftoken + "&count=" + count;
            $.ajax({
                type: "POST",
                url: "/buy_lootboxes/",
                data:  sending_data,
                cache: false,
                success: function(data){
                    if (data.response == 'ok'){
                        location.reload();
                    }
                    else{
                        display_modal('notify', data.header, data.response, null, data.grey_btn);
                    }
                }
            });
        };


		class Carousel {
			constructor(containerId) {
				this.container = document.getElementById(containerId);
				this.list = this.container.querySelector('.carList');
				this.itemsArr1 = [...this.container.querySelectorAll('.carItem')];
				this.modalInfo1 = this.container.querySelector('.box__modal1info');
				this.modalInfo3 = this.container.querySelector('.box__modal3info');

				const itemWidth = document.querySelector('.carImg').getBoundingClientRect().width;
			}

			shuffle(array) {
				const arr = [...array];
				let currentIndex = arr.length;
				while (currentIndex != 0) {
					let randomIndex = Math.floor(Math.random() * currentIndex);
					currentIndex--;
					[arr[currentIndex], arr[randomIndex]] = [
						arr[randomIndex], arr[currentIndex]];
				}
				return arr;
			}

			shuffleItems() {
				this.itemsArr2 = this.shuffle(this.itemsArr1);
				this.itemsArr3 = this.shuffle(this.itemsArr1);
			}

			appendItems() {
				this.itemsArr2.forEach((item) => this.list.appendChild(item.cloneNode(true)));
				this.itemsArr3.forEach((item) => this.list.appendChild(item.cloneNode(true)));
            }

			startCarousel(targetImageName) {
				if (this.modalInfo1) this.modalInfo1.classList.remove('active');
				if (this.modalInfo3) this.modalInfo3.classList.remove('active');
				this.list.style.transition = 'none';
				this.list.style.transform = 'translateX(0)';
				if (this.list.children.length > this.itemsArr1.length) {
					this.list.innerHTML = '';
					this.itemsArr1.forEach((item) => this.list.appendChild(item.cloneNode(true)));
				}
				this.shuffleItems();

				const imgInLastArrIndex = this.itemsArr2.findIndex((item) => item.querySelector('img').src.match(new RegExp(targetImageName + `(?=[.])`)));
				const middleIndex = this.itemsArr2.length / 2 - 1;

				if (imgInLastArrIndex && imgInLastArrIndex !== middleIndex) {
					[this.itemsArr2[imgInLastArrIndex], this.itemsArr2[middleIndex]] = [this.itemsArr2[middleIndex], this.itemsArr2[imgInLastArrIndex]];
				}

				this.appendItems();

				const itemsLendth = this.itemsArr1.length;
				setTimeout(() => {
					this.list.style.transition = '';
					this.list.style.transform = `translateX(-${((itemsLendth * 1) + (itemsLendth / 2) - 1) * 200 - 60}px)`;

                    const cancelTransition = () => {
						this.list.style.transition = 'none';
						if (boxPage.state.isPopup1Opened) { this.modalInfo1.classList.add('active'); }
						if (boxPage.state.isPopup3Opened) { this.modalInfo3.classList.add('active'); };
					};
					this.list.addEventListener('click', cancelTransition);
					this.cancelTransitionRemove = () => { this.list.removeEventListener('click', cancelTransition); };

					if (this.modalInfo1) {
						setTimeout(() => {
							if (boxPage.state.isPopup1Opened) { this.modalInfo1.classList.add('active'); };
							this.list.removeEventListener('click', cancelTransition);
						}, 7500);
					}
					if (this.modalInfo3) {
						setTimeout(() => {
							if (boxPage.state.isPopup3Opened) { this.modalInfo3.classList.add('active'); };
							this.list.removeEventListener('click', cancelTransition);
						}, 7500);
					}
				}, 0);
			}
		}

		const carousel1 = new Carousel('carousel1');
		const carousel2 = new Carousel('carousel2');
		const carousel3 = new Carousel('carousel3');
		const carousel4 = new Carousel('carousel4');

	</script>

	<script>
        // кейсы - запустить открытие
        function open_aviaboxes(count, mode){
            var sending_data = "&csrfmiddlewaretoken=" + csrftoken + "&count=" + count + "&mode=" + mode;

            return fetch("/open_aviaboxes/", {
              "headers": {
                "accept": "*/*",
                "content-type": "application/x-www-form-urlencoded; charset=UTF-8",
              },
              "body": sending_data,
              "method": "POST",
              "credentials": "include"
            });
        };

		const sleep = (time) => {
			return new Promise((res) => {
				setTimeout(() => res(), time);
			});
		};

		class BoxPage {
			constructor() {
				this.plusBtn = document.querySelector('.box__picBtn');
				this.tabs = document.querySelectorAll('.ct__top-tab');
				this.blocks = document.querySelectorAll('.box__block');

				this.chestImg = document.querySelector('.box__picImg');
				this.goToBuyBtn = document.querySelector('.box__picBtn');

				this.openChestBtns = document.querySelector('.box__picBtns');
				this.openChestBtn = document.querySelector('.box__picOpen');
				this.openChest10Btn = document.querySelector('.box__picOpen10');
				this.openChestAllBtn = document.querySelector('.box__picOpenAll');

				this.popup1 = document.querySelector('.box__modal1');
				this.popupClose1 = document.querySelector('.box__close1');
				this.popup3 = document.querySelector('.box__modal3');
				this.popupClose3 = document.querySelector('.box__close3');
				this.popup1continue = document.getElementById('modal__continue1');
				this.popup3continue = document.getElementById('modal__continue3');
				this.popup1restart = document.getElementById('modal__restart1');
<!--				this.popup3restart = document.getElementById('modal__restart3');-->

				this.goldContent = document.querySelector('.box__itemCount--gold');
				this.premContent = document.querySelector('.box__itemCount--prem');
				this.wpContent = document.querySelector('.box__itemCount--wp');

				this.chestCountContainer = document.querySelector('.box__picChestCount');
				this.chestCount = document.querySelector('.box__picChestCount--count');

                this.chestGarantContainer = document.querySelector('.box__garantCount');
				this.garantCount = document.querySelector('.box__garantCount--count');

				this.loader = document.querySelector('.wp-loader-wrapper');

				this.stateData = {
					currentBlock: 0, //какой текущий блок показывается 0 или 1
					chestCount: {% localize off %}{{ lootbox_count }}{% endlocalize %}, //сколько у чувака сундуков
					garantCount: {% localize off %}{{ garant_count }}{% endlocalize %}, //сколько у чувака сундуков
					isPopup1Opened: false, //открыт ли попап с 1 наградами
					isPopup3Opened: false, //открыт ли попап с 3 наградами
					goldReward: '', //сколько золота в награде
					premReward: '', //сколько према в награде
					wpReward: '', //сколько wild pass'ов в награде
					isLoading: false, //идет ли загрузка запроса
				};

				const rerender = {
					set: (obj, prop, value) => {
						switch (prop) {
							case "currentBlock":
								value === 0 ? this.tabs[0].classList.add('active') : this.tabs[0].classList.remove('active');
								value === 1 ? this.tabs[1].classList.add('active') : this.tabs[1].classList.remove('active');
								value === 0 ? this.blocks[0].classList.add('active') : this.blocks[0].classList.remove('active');
								value === 1 ? this.blocks[1].classList.add('active') : this.blocks[1].classList.remove('active');
								obj[prop] = value; return true;

							case "chestCount":
								value === 0 ? this.goToBuyBtn.style.display = '' : this.goToBuyBtn.style.display = 'none';
								value === 0 ? this.chestImg.style.filter = 'grayscale(1)' : this.chestImg.style.filter = 'grayscale(0)';
								value === 0 ? this.openChestBtns.style.display = 'none' : this.openChestBtns.style.display = '';
								value >= 3 ? this.openChest10Btn.style.display = '' : this.openChest10Btn.style.display = 'none';
								value > 0 ? this.chestCountContainer.style.display = '' : this.chestCountContainer.style.display = 'none';
								if (value > 0) this.chestCount.textContent = value;
								obj[prop] = value; return true;

                            case "garantCount":
								this.garantCount.textContent = value;
								obj[prop] = value; return true;

							case "isPopup1Opened":
								value ? this.popup1.classList.add('active') : this.popup1.classList.remove('active');
								obj[prop] = value; return true;

							case "isPopup3Opened":
								value ? this.popup3.classList.add('active') : this.popup3.classList.remove('active');
								obj[prop] = value; return true;

							case "goldReward":
								value ? this.goldContent.parentNode.style.display = '' : this.goldContent.parentNode.style.display = 'none';
								this.goldContent.textContent = value;
								obj[prop] = value; return true;

							case "premReward":
								value ? this.premContent.parentNode.style.display = '' : this.premContent.parentNode.style.display = 'none';
								this.premContent.textContent = value;
								obj[prop] = value; return true;

							case "wpReward":
								value ? this.wpContent.parentNode.style.display = '' : this.wpContent.parentNode.style.display = 'none';
								this.wpContent.textContent = value;
								obj[prop] = value; return true;

							case "isLoading":
								value ? this.loader.classList.add('active') : this.loader.classList.remove('active');
								obj[prop] = value; return true;
						}
					}
				};

				this.state = new Proxy(this.stateData, rerender);

				this.setEventListeners();
				this.state.isLoading = false;
				this.state.chestCount = {% localize off %}{{ lootbox_count }}{% endlocalize %};
				this.state.garantCount = {% localize off %}{{ garant_count }}{% endlocalize %};
			}

			setEventListeners() {
				this.goToBuyBtn.addEventListener('click', () => this.state.currentBlock = 1);
				this.tabs[0].addEventListener('click', () => this.state.currentBlock = 0);
				this.tabs[1].addEventListener('click', () => this.state.currentBlock = 1);
				this.popupClose1.addEventListener('click', () => {
					this.state.isPopup1Opened = false;
					carousel1.modalInfo1.classList.remove('active');
					carousel1.cancelTransitionRemove();
				});
				this.popup1continue.addEventListener('click', () => this.state.isPopup1Opened = false);
				this.popupClose3.addEventListener('click', () => {
					this.state.isPopup3Opened = false;
					carousel4.modalInfo3.classList.remove('active');
					carousel4.cancelTransitionRemove();
				});
				this.popup3continue.addEventListener('click', () => this.state.isPopup3Opened = false);

				this.popup1restart.addEventListener('click', async () => {

				    var response = await open_aviaboxes(1, 'rerun');

				    var data = await response.json();

                    if(data !== null){
                        if (data.response == 'ok'){
                            actualize();

                            $('#modal__restart1').show();
                            if (data.prizes[0][0][0] == 'gold'){
                                $('#modal__restart1').hide();
                            }

                            this.state.isPopup1Opened = true;

                            document.getElementById("prize_name").innerHTML = numberWithSpaces(data.prizes[0][1]);
                            document.getElementById("prize_rarity").innerHTML = numberWithSpaces(data.prizes[0][2]);

                            carousel1.startCarousel(
                                    data.prizes[0][0][0].concat("_", data.prizes[0][0][1])
                                                );


                            this.state.chestCount = data.boxes_count;
                            this.state.garantCount = data.garant_count;
                        }
                        else{
                            display_modal('notify', data.header, data.response, null, data.grey_btn);
                        }
                    };
				});

<!--				this.popup3restart.addEventListener('click', () => {-->
<!--					carousel2.startCarousel('tyan3');-->
<!--					carousel3.startCarousel('tyan2');-->
<!--					carousel4.startCarousel('tyan1');-->
<!--				});-->

				this.openChestBtn.addEventListener('click', async () => {

				    var response = await open_aviaboxes(1, 'open');

				    var data = await response.json();

                    if(data !== null){
                        if (data.response == 'ok'){
                            actualize();

                            $('#modal__restart1').show();
                            if (data.prizes[0][0][0] == 'gold'){
                                $('#modal__restart1').hide();
                            }

                            this.state.isPopup1Opened = true;

                            document.getElementById("prize_name").innerHTML = numberWithSpaces(data.prizes[0][1]);
                            document.getElementById("prize_rarity").innerHTML = numberWithSpaces(data.prizes[0][2]);

                            carousel1.startCarousel(
                                    data.prizes[0][0][0].concat("_", data.prizes[0][0][1])
                                                );

                            this.state.chestCount = data.boxes_count;
                            this.state.garantCount = data.garant_count;
                        }
                        else{
                            display_modal('notify', data.header, data.response, null, data.grey_btn);
                        }
                    };
				});

				this.openChest10Btn.addEventListener('click', async () => {

                    var response = await open_aviaboxes(3, 'open');

				    var data = await response.json();

                    if(data !== null){
                        if (data.response == 'ok'){
                            actualize();

                            this.state.isPopup3Opened = true;

                            carousel1.startCarousel(
                                    data.prizes[0][0][0].concat("_", data.prizes[0][0][1])
                                                );

                            carousel2.startCarousel(
                                    data.prizes[0][0][0].concat("_", data.prizes[0][0][1])
                                                );
                            carousel3.startCarousel(
                                    data.prizes[1][0][0].concat("_", data.prizes[1][0][1])
                                                );
                            carousel4.startCarousel(
                                    data.prizes[2][0][0].concat("_", data.prizes[2][0][1])
                                                );

                            this.state.chestCount = data.boxes_count;
                            this.state.garantCount = data.garant_count;
                        }
                        else{
                            display_modal('notify', data.header, data.response, null, data.grey_btn);
                        }
                    };
				});

			}
		}

		const boxPage = new BoxPage();

		/* модалки с самолётами */
		const flyModal1 = document.getElementById('flyModal1');
		const flyModal2 = document.getElementById('flyModal2');
		const flyModal3 = document.getElementById('flyModal3');
		const flyModal1Open = document.getElementById('flyModalOpen1');
		const flyModal2Open = document.getElementById('flyModalOpen2');
		const flyModal3Open = document.getElementById('flyModalOpen3');
		const flyModal1Close = flyModal1.querySelector('.box__close');
		const flyModal2Close = flyModal2.querySelector('.box__close');
		const flyModal3Close = flyModal3.querySelector('.box__close');

		flyModal1Open.addEventListener('click', () => { flyModal1.classList.add('active'); });
		flyModal2Open.addEventListener('click', () => { flyModal2.classList.add('active'); });
		flyModal3Open.addEventListener('click', () => { flyModal3.classList.add('active'); });
		flyModal3Open.addEventListener('click', () => { flyModal3.classList.add('active'); });

		flyModal1Close.addEventListener('click', () => { flyModal1.classList.remove('active'); });
		flyModal2Close.addEventListener('click', () => { flyModal2.classList.remove('active'); });
		flyModal3Close.addEventListener('click', () => { flyModal3.classList.remove('active'); });

		console.log('вариантов всего: ' + {{ variants }})
</script>
{% endblock %}