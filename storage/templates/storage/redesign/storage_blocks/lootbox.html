{% extends 'player/redesign/header.html' %}
{% load get_mul %}
{% load dict_key %}
{% load static %}
{% load l10n %}{% load i18n %}

{% block content %}
<section class="box custom-scroll">
		<!-- Заголовок -->
		<h1 class="box__title ct__page-title">Новогодние сундуки</h1>


    <!-- Табы -->
    <div class="box__tabs ct__top-tabs">
      <button class="ct__top-tab ct__top-tab1 active ct__mid-btn">
        <svg width="144" height="30" viewBox="0 0 144 30" xmlns="http://www.w3.org/2000/svg">
          <mask id="mask0_259_317" style="mask-type:alpha" maskUnits="userSpaceOnUse" x="0" y="0" width="144" height="30">
            <path class="geometry1" d="M0 5.76923L5.76923 0H144V23.0769L137.077 30H0V5.76923Z"/>
          </mask>
          <g mask="url(#mask0_259_317)">
            <path class="geometry2" d="M0 5.76917L5.76923 -6.10352e-05H144V23.0769L137.077 29.9999H0V5.76917Z"/>
            <path class="treg1" opacity="0.15" d="M109.266 13.4468L125.407 3.59524L125.868 22.4997L109.266 13.4468Z" fill="var(--c10one)"/>
            <path class="treg2" opacity="0.15" d="M95.6185 -3.53072L103.36 25.3596L74.4694 17.6185L95.6185 -3.53072Z" fill="var(--c10one)"/>
            <path class="treg3" opacity="0.15" d="M22.6079 -8.73057L72.591 7.62749L33.433 42.7351L22.6079 -8.73057Z" fill="var(--c10one)"/>
          </g>
        </svg>
        <span>мои сундуки</span>
      </button>

      <button class="ct__top-tab ct__top-tab2 ct__mid-btn">
        <svg width="144" height="30" viewBox="0 0 144 30" xmlns="http://www.w3.org/2000/svg">
          <mask id="mask0_259_318" style="mask-type:alpha" maskUnits="userSpaceOnUse" x="0" y="0" width="144" height="30">
            <path class="geometry1" d="M0 5.76923L5.76923 0H144V23.0769L137.077 30H0V5.76923Z"/>
          </mask>
          <g mask="url(#mask0_259_318)">
            <path class="geometry2" d="M0 5.76917L5.76923 -6.10352e-05H144V23.0769L137.077 29.9999H0V5.76917Z"/>
            <path class="treg1" opacity="0.15" d="M109.266 13.4468L125.407 3.59524L125.868 22.4997L109.266 13.4468Z" fill="var(--c10one)"/>
            <path class="treg2" opacity="0.15" d="M95.6185 -3.53072L103.36 25.3596L74.4694 17.6185L95.6185 -3.53072Z" fill="var(--c10one)"/>
            <path class="treg3" opacity="0.15" d="M22.6079 -8.73057L72.591 7.62749L33.433 42.7351L22.6079 -8.73057Z" fill="var(--c10one)"/>
          </g>
        </svg>
        <span>приобрести</span>
      </button>
    </div>

    <!-- Блок "Мои сундуки" -->
    <div class="box__block active">
      <p class="box__desc">
        Открывайте новогодние сундуки и получайте разнообразные награды!
      </p>

      <div class="box__pic">
        <img class="box__picImg" src="{% static 'img/chest.png' %}" alt="">

        <button class="box__picBtn">
          <span>У вас нет сундуков с сокровищами</span>
          <svg width="90" height="90" viewBox="0 0 90 90" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M45 0C33.0653 3.35549e-05 21.6194 4.7411 13.1802 13.1802C4.7411 21.6194 3.35549e-05 33.0653 0 45C3.34951e-05 56.9347 4.7411 68.3806 13.1802 76.8198C21.6194 85.2589 33.0653 90 45 90C56.9347 90 68.3806 85.2589 76.8198 76.8198C85.2589 68.3806 90 56.9347 90 45C90 33.0653 85.2589 21.6194 76.8198 13.1802C68.3806 4.7411 56.9347 3.34951e-05 45 0ZM45 8.01812C54.8082 8.01815 64.2147 11.9145 71.1501 18.8499C78.0855 25.7853 81.9818 35.1918 81.9819 45C81.9818 54.8082 78.0855 64.2147 71.1501 71.1501C64.2147 78.0855 54.8082 81.9818 45 81.9819C35.1918 81.9818 25.7853 78.0855 18.8499 71.1501C11.9145 64.2147 8.01815 54.8082 8.01812 45C8.01815 35.1918 11.9145 25.7853 18.8499 18.8499C25.7853 11.9145 35.1918 8.01815 45 8.01812ZM44.5345 24.7951C42.5323 24.7951 40.9205 26.4069 40.9205 28.4091V40.9205H28.4091C26.4069 40.9205 24.7951 42.5323 24.7951 44.5345V45.4655C24.7951 47.4677 26.4069 49.0795 28.4091 49.0795H40.9205V61.5909C40.9205 63.5931 42.5323 65.2049 44.5345 65.2049H45.4655C47.4677 65.2049 49.0795 63.5931 49.0795 61.5909V49.0795H61.5909C63.5931 49.0795 65.2049 47.4677 65.2049 45.4655V44.5345C65.2049 42.5323 63.5931 40.9205 61.5909 40.9205H49.0795V28.4091C49.0795 26.4069 47.4677 24.7951 45.4655 24.7951H44.5345Z" fill="white"/>
          </svg>
          <span>приобрести</span>
        </button>

        <div class="box__picBtns">
            <button class="box__picOpen ct__mid-btn">
                <svg width="144" height="30" viewBox="0 0 144 30" xmlns="http://www.w3.org/2000/svg">
                    <mask id="mask0_258_218" style="mask-type:alpha" maskUnits="userSpaceOnUse" x="0" y="0" width="144" height="30">
                        <path class="geometry1" d="M0 5.76923L5.76923 0H144V23.0769L137.077 30H0V5.76923Z"/>
                    </mask>
                    <g mask="url(#mask0_258_218)">
                        <path class="geometry2" fill="var(--c10two)" d="M0 5.76917L5.76923 -6.10352e-05H144V23.0769L137.077 29.9999H0V5.76917Z"/>
                        <path class="treg1" opacity="0.15" d="M109.266 13.4468L125.407 3.59524L125.868 22.4997L109.266 13.4468Z" fill="var(--c10one)"/>
                        <path class="treg2" opacity="0.15" d="M95.6185 -3.53072L103.36 25.3596L74.4694 17.6185L95.6185 -3.53072Z" fill="var(--c10one)"/>
                        <path class="treg3" opacity="0.15" d="M22.6079 -8.73057L72.591 7.62749L33.433 42.7351L22.6079 -8.73057Z" fill="var(--c10one)"/>
                    </g>
                </svg>
                <span>Открыть</span>
            </button>

            <button class="box__picOpen10 ct__mid-btn">
                <svg width="144" height="30" viewBox="0 0 144 30" xmlns="http://www.w3.org/2000/svg">
                    <mask id="mask0_258_219" style="mask-type:alpha" maskUnits="userSpaceOnUse" x="0" y="0" width="144" height="30">
                        <path class="geometry1" d="M0 5.76923L5.76923 0H144V23.0769L137.077 30H0V5.76923Z"/>
                    </mask>
                    <g mask="url(#mask0_258_219)">
                        <path class="geometry2" fill="var(--c10two)" d="M0 5.76917L5.76923 -6.10352e-05H144V23.0769L137.077 29.9999H0V5.76917Z"/>
                        <path class="treg1" opacity="0.15" d="M109.266 13.4468L125.407 3.59524L125.868 22.4997L109.266 13.4468Z" fill="var(--c10one)"/>
                        <path class="treg2" opacity="0.15" d="M95.6185 -3.53072L103.36 25.3596L74.4694 17.6185L95.6185 -3.53072Z" fill="var(--c10one)"/>
                        <path class="treg3" opacity="0.15" d="M22.6079 -8.73057L72.591 7.62749L33.433 42.7351L22.6079 -8.73057Z" fill="var(--c10one)"/>
                    </g>
                </svg>
                <span>Открыть х10</span>
            </button>

            <button class="box__picOpenAll ct__mid-btn active">
                <svg width="144" height="30" viewBox="0 0 144 30" xmlns="http://www.w3.org/2000/svg">
                    <mask id="mask0_258_220" style="mask-type:alpha" maskUnits="userSpaceOnUse" x="0" y="0" width="144" height="30">
                        <path class="geometry1" d="M0 5.76923L5.76923 0H144V23.0769L137.077 30H0V5.76923Z"/>
                    </mask>
                    <g mask="url(#mask0_258_220)">
                        <path class="geometry2" fill="var(--c10two)" d="M0 5.76917L5.76923 -6.10352e-05H144V23.0769L137.077 29.9999H0V5.76917Z"/>
                        <path class="treg1" opacity="0.15" d="M109.266 13.4468L125.407 3.59524L125.868 22.4997L109.266 13.4468Z" fill="var(--c10one)"/>
                        <path class="treg2" opacity="0.15" d="M95.6185 -3.53072L103.36 25.3596L74.4694 17.6185L95.6185 -3.53072Z" fill="var(--c10one)"/>
                        <path class="treg3" opacity="0.15" d="M22.6079 -8.73057L72.591 7.62749L33.433 42.7351L22.6079 -8.73057Z" fill="var(--c10one)"/>
                    </g>
                </svg>
                <span>Открыть все</span>
            </button>
        </div>
      </div>

      <p class="box__desc">
        В этом сундуке вы можете найти:
      </p>

      <ul class="box__list">
        <li class="box__item">
          <svg width="66" height="43" viewBox="0 0 66 43" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M25.5611 0L21.7542 13.2737H43.5083L40.2452 0H25.5611Z" fill="#EB9929"/>
            <path d="M14.8684 14.3799L11.0614 27.6536H32.8156L29.5525 14.3799H14.8684Z" fill="#EB9929"/>
            <path d="M25.9299 28.7598L22.1229 42.0335H43.8771L40.614 28.7598H25.9299Z" fill="#EB9929"/>
            <path d="M48.0528 28.7598L44.2458 42.0335H66L62.7369 28.7598H48.0528Z" fill="#EB9929"/>
            <path d="M3.80698 28.7598L0 42.0335H21.7542L18.4911 28.7598H3.80698Z" fill="#EB9929"/>
            <path d="M36.9913 14.3799L33.1843 27.6536H54.9385L51.6754 14.3799H36.9913Z" fill="#EB9929"/>
          </svg>
          <div class="box__itemBlock">
            <h2>Игровое золото</h2>
            <ul class="box__innerList">
              <li>500</li>
              <li>1K</li>
              <li>3K</li>
              <li>100K</li>
            </ul>
          </div>
        </li>

        <li class="box__item">
          <img src="img/prem2.png" alt="">
          <div class="box__itemBlock">
            <h2>Дни премиум-аккаунта</h2>
            <ul class="box__innerList">
              <li>14</li>
              <li>30</li>
              <li>90</li>
              <li>365</li>
            </ul>
          </div>
        </li>

        <li class="box__item">
          <img src="img/wp.png" alt="">
          <div class="box__itemBlock">
            <h2>Wild pass</h2>
            <ul class="box__innerList">
              <li>1</li>
              <li>3</li>
              <li>5</li>
              <li>10</li>
            </ul>
          </div>
        </li>
      </ul>
    </div>
    <!-- КОНЕЦ: Блок "Мои сундуки" -->


    <!-- Блок "Приобрести" -->
    <div class="box__block">
      <p class="box__desc">
        Приобретите наборы новогодних сундуков с приятной выгодой!
      </p>

      <ul class="box__buyList">
        <li class="box__buyItem">
          <img src="{% static 'img/chest.png' %}" alt="">
          <span>x1</span>
          <div class="box__buyBtnBlock">
            <button class="ct__mid-btn">
              <svg width="144" height="30" viewBox="0 0 144 30" xmlns="http://www.w3.org/2000/svg">
                <mask id="mask0_59_315" style="mask-type:alpha" maskUnits="userSpaceOnUse" x="0" y="0" width="144" height="30">
                  <path class="geometry1" d="M0 5.76923L5.76923 0H144V23.0769L137.077 30H0V5.76923Z"/>
                </mask>
								<g mask="url(#mask0_59_315)">
									<path class="geometry2" fill="var(--c10two)" d="M0 5.76917L5.76923 -6.10352e-05H144V23.0769L137.077 29.9999H0V5.76917Z"/>
									<path class="treg1" opacity="0.15" d="M109.266 13.4468L125.407 3.59524L125.868 22.4997L109.266 13.4468Z" fill="var(--c10one)"/>
									<path class="treg2" opacity="0.15" d="M95.6185 -3.53072L103.36 25.3596L74.4694 17.6185L95.6185 -3.53072Z" fill="var(--c10one)"/>
									<path class="treg3" opacity="0.15" d="M22.6079 -8.73057L72.591 7.62749L33.433 42.7351L22.6079 -8.73057Z" fill="var(--c10one)"/>
								</g>
              </svg>
              <span>1000 G</span>
            </button>
          </div>
        </li>

        <li class="box__buyItem">
          <img src="{% static 'img/chest.png' %}" alt="">
          <span>x5</span>
          <div class="box__buyBtnBlock">
            <button class="ct__mid-btn">
              <svg width="144" height="30" viewBox="0 0 144 30" xmlns="http://www.w3.org/2000/svg">
                <mask id="mask0_59_316" style="mask-type:alpha" maskUnits="userSpaceOnUse" x="0" y="0" width="144" height="30">
                  <path class="geometry1" d="M0 5.76923L5.76923 0H144V23.0769L137.077 30H0V5.76923Z"/>
                </mask>
                <g mask="url(#mask0_59_316)">
                    <path class="geometry2" fill="var(--c10two)" d="M0 5.76917L5.76923 -6.10352e-05H144V23.0769L137.077 29.9999H0V5.76917Z"/>
                    <path class="treg1" opacity="0.15" d="M109.266 13.4468L125.407 3.59524L125.868 22.4997L109.266 13.4468Z" fill="var(--c10one)"/>
                    <path class="treg2" opacity="0.15" d="M95.6185 -3.53072L103.36 25.3596L74.4694 17.6185L95.6185 -3.53072Z" fill="var(--c10one)"/>
                    <path class="treg3" opacity="0.15" d="M22.6079 -8.73057L72.591 7.62749L33.433 42.7351L22.6079 -8.73057Z" fill="var(--c10one)"/>
                </g>
              </svg>
              <span>4500 G</span>
            </button>
            <p class="box__sale">скидка: <span>G 500</span></p>
          </div>
        </li>

        <li class="box__buyItem">
          <img src="{% static 'img/chest.png' %}" alt="">
          <span>x10</span>
          <div class="box__buyBtnBlock">
            <button class="ct__mid-btn">
              <svg width="144" height="30" viewBox="0 0 144 30" xmlns="http://www.w3.org/2000/svg">
                <mask id="mask0_59_317" style="mask-type:alpha" maskUnits="userSpaceOnUse" x="0" y="0" width="144" height="30">
                  <path class="geometry1" d="M0 5.76923L5.76923 0H144V23.0769L137.077 30H0V5.76923Z"/>
                </mask>
								<g mask="url(#mask0_59_317)">
									<path class="geometry2" fill="var(--c10two)" d="M0 5.76917L5.76923 -6.10352e-05H144V23.0769L137.077 29.9999H0V5.76917Z"/>
									<path class="treg1" opacity="0.15" d="M109.266 13.4468L125.407 3.59524L125.868 22.4997L109.266 13.4468Z" fill="var(--c10one)"/>
									<path class="treg2" opacity="0.15" d="M95.6185 -3.53072L103.36 25.3596L74.4694 17.6185L95.6185 -3.53072Z" fill="var(--c10one)"/>
									<path class="treg3" opacity="0.15" d="M22.6079 -8.73057L72.591 7.62749L33.433 42.7351L22.6079 -8.73057Z" fill="var(--c10one)"/>
								</g>
              </svg>
              <span>8500 G</span>
            </button>
            <p class="box__sale">скидка: <span>G 1500</span></p>
          </div>
        </li>

        <li class="box__buyItem">
          <img src="{% static 'img/chest.png' %}" alt="">
          <span>x50</span>
          <div class="box__buyBtnBlock">
            <button class="ct__mid-btn">
              <svg width="144" height="30" viewBox="0 0 144 30" xmlns="http://www.w3.org/2000/svg">
                <mask id="mask0_59_318" style="mask-type:alpha" maskUnits="userSpaceOnUse" x="0" y="0" width="144" height="30">
                  <path class="geometry1" d="M0 5.76923L5.76923 0H144V23.0769L137.077 30H0V5.76923Z"/>
                </mask>
								<g mask="url(#mask0_59_318)">
									<path class="geometry2" fill="var(--c10two)" d="M0 5.76917L5.76923 -6.10352e-05H144V23.0769L137.077 29.9999H0V5.76917Z"/>
									<path class="treg1" opacity="0.15" d="M109.266 13.4468L125.407 3.59524L125.868 22.4997L109.266 13.4468Z" fill="var(--c10one)"/>
									<path class="treg2" opacity="0.15" d="M95.6185 -3.53072L103.36 25.3596L74.4694 17.6185L95.6185 -3.53072Z" fill="var(--c10one)"/>
									<path class="treg3" opacity="0.15" d="M22.6079 -8.73057L72.591 7.62749L33.433 42.7351L22.6079 -8.73057Z" fill="var(--c10one)"/>
								</g>
              </svg>
              <span>40 000 G</span>
            </button>
            <p class="box__sale">скидка: <span>G 10 000</span></p>
          </div>
        </li>

        <li class="box__buyItem">
          <img src="{% static 'img/chest.png' %}" alt="">
          <span>x100</span>
          <div class="box__buyBtnBlock">
            <button class="ct__mid-btn">
              <svg width="144" height="30" viewBox="0 0 144 30" xmlns="http://www.w3.org/2000/svg">
                <mask id="mask0_59_319" style="mask-type:alpha" maskUnits="userSpaceOnUse" x="0" y="0" width="144" height="30">
                  <path class="geometry1" d="M0 5.76923L5.76923 0H144V23.0769L137.077 30H0V5.76923Z"/>
                </mask>
								<g mask="url(#mask0_59_319)">
									<path class="geometry2" fill="var(--c10two)" d="M0 5.76917L5.76923 -6.10352e-05H144V23.0769L137.077 29.9999H0V5.76917Z"/>
									<path class="treg1" opacity="0.15" d="M109.266 13.4468L125.407 3.59524L125.868 22.4997L109.266 13.4468Z" fill="var(--c10one)"/>
									<path class="treg2" opacity="0.15" d="M95.6185 -3.53072L103.36 25.3596L74.4694 17.6185L95.6185 -3.53072Z" fill="var(--c10one)"/>
									<path class="treg3" opacity="0.15" d="M22.6079 -8.73057L72.591 7.62749L33.433 42.7351L22.6079 -8.73057Z" fill="var(--c10one)"/>
								</g>
              </svg>
              <span>75 000 G</span>
            </button>
            <p class="box__sale">скидка: <span>G 25 000</span></p>
          </div>
        </li>
      </ul>
    </div>
    <!-- КОНЕЦ: Блок "Приобрести" -->


		<!-- Модалка с лутом -->
		<div class="box__modal custom-scroll">
			<button class="box__close">
				<svg width="32" height="32" viewBox="0 0 32 32" fill="none" xmlns="http://www.w3.org/2000/svg">
					<path d="M1 1L31 31M31 1L1.53571 30.4643" stroke-width="1" stroke="var(--c10one)"/>
				</svg>
			</button>

			<h3 class="box__subTitle">
        А вот и подарки!
      </h3>

			<div class="box__pic box__pic--anima">
        <img src="{% static 'img/chest.png' %}" alt="">
      </div>

			<h3 class="box__subTitle">Вот что было в сундуке:</h3>

			<ul class="box__list box__list--modal">
        <li class="box__item">
          <svg width="66" height="43" viewBox="0 0 66 43" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M25.5611 0L21.7542 13.2737H43.5083L40.2452 0H25.5611Z" fill="#EB9929"/>
            <path d="M14.8684 14.3799L11.0614 27.6536H32.8156L29.5525 14.3799H14.8684Z" fill="#EB9929"/>
            <path d="M25.9299 28.7598L22.1229 42.0335H43.8771L40.614 28.7598H25.9299Z" fill="#EB9929"/>
            <path d="M48.0528 28.7598L44.2458 42.0335H66L62.7369 28.7598H48.0528Z" fill="#EB9929"/>
            <path d="M3.80698 28.7598L0 42.0335H21.7542L18.4911 28.7598H3.80698Z" fill="#EB9929"/>
            <path d="M36.9913 14.3799L33.1843 27.6536H54.9385L51.6754 14.3799H36.9913Z" fill="#EB9929"/>
          </svg>
					<span class="box__itemCount box__itemCount--gold"></span>
        </li>

        <li class="box__item">
          <img src="img/prem2.png" alt="">
					<span class="box__itemCount box__itemCount--prem"></span>
        </li>

        <li class="box__item">
          <img src="img/wp.png" alt="">
					<span class="box__itemCount box__itemCount--wp"></span>
        </li>
      </ul>

		</div>
		<!-- КОНЕЦ: Модалка с лутом -->

		<div class="wp-loader-wrapper">
			<span class="wp-loader"></span>
		</div>

	</section>
{% endblock %}

{% block for_scripts_and_css %}
{% endblock %}

<script>

	const sleep = (time) => {
		return new Promise((res) => {
			setTimeout(() => res(), time);
		})
	}

	class BoxPage {
		constructor() {
			this.plusBtn = document.querySelector('.box__picBtn');
			this.tabs = document.querySelectorAll('.ct__top-tab');
			this.blocks = document.querySelectorAll('.box__block');

			this.chestImg = document.querySelector('.box__picImg');
			this.goToBuyBtn = document.querySelector('.box__picBtn');

			this.openChestBtns = document.querySelector('.box__picBtns');
			this.openChestBtn = document.querySelector('.box__picOpen');
			this.openChest10Btn = document.querySelector('.box__picOpen10');
			this.openChestAllBtn = document.querySelector('.box__picOpenAll');

			this.popup = document.querySelector('.box__modal');
			this.popupClose = document.querySelector('.box__close');

			this.goldContent = document.querySelector('.box__itemCount--gold');
			this.premContent = document.querySelector('.box__itemCount--prem');
			this.wpContent = document.querySelector('.box__itemCount--wp');

			this.loader = document.querySelector('.wp-loader-wrapper');

			this.stateData = {
				currentBlock: 0, //какой текущий блок показывается 0 или 1
				chestCount: 10, //сколько у чувака сундуков
				isPopupOpened: false, //открыт ли попап с наградами
				goldReward: '', //сколько золота в награде
				premReward: '', //сколько према в награде
				wpReward: '', //сколько wild pass'ов в награде
				isLoading: false, //идет ли загрузка запроса
			}

			const rerender = {
				set: (obj, prop, value) => {
					switch (prop) {
						case "currentBlock":
							value === 0 ? this.tabs[0].classList.add('active') : this.tabs[0].classList.remove('active');
							value === 1 ? this.tabs[1].classList.add('active') : this.tabs[1].classList.remove('active');
							value === 0 ? this.blocks[0].classList.add('active') : this.blocks[0].classList.remove('active');
							value === 1 ? this.blocks[1].classList.add('active') : this.blocks[1].classList.remove('active');
							obj[prop] = value; return true;

						case "chestCount":
							value === 0 ? this.goToBuyBtn.style.display = '' : this.goToBuyBtn.style.display = 'none';
							value === 0 ? this.chestImg.style.filter = 'grayscale(1)' : this.chestImg.style.filter = 'grayscale(0)';
							value === 0 ? this.openChestBtns.style.display = 'none' : this.openChestBtns.style.display = '';
							value >= 10 ? this.openChest10Btn.style.display = '' : this.openChest10Btn.style.display = 'none';
							value > 1 && value < 10 ? this.openChestAllBtn.style.display = '' : this.openChestAllBtn.style.display = 'none';
							obj[prop] = value; return true;

						case "isPopupOpened":
							value ? this.popup.classList.add('active') : this.popup.classList.remove('active');
							obj[prop] = value; return true;

						case "goldReward":
							value ? this.goldContent.parentNode.style.display = '' : this.goldContent.parentNode.style.display = 'none';
							this.goldContent.textContent = value;
							obj[prop] = value; return true;

						case "premReward":
							value ? this.premContent.parentNode.style.display = '' : this.premContent.parentNode.style.display = 'none';
							this.premContent.textContent = value;
							obj[prop] = value; return true;

						case "wpReward":
							value ? this.wpContent.parentNode.style.display = '' : this.wpContent.parentNode.style.display = 'none';
							this.wpContent.textContent = value;
							obj[prop] = value; return true;

						case "isLoading":
							value ? this.loader.classList.add('active') : this.loader.classList.remove('active');
							obj[prop] = value; return true;
					}
				}
			}

			this.state = new Proxy(this.stateData, rerender);

			this.setEventListeners();
			this.state.isLoading = false;
			this.state.chestCount = 2;
		}

		setEventListeners() {
			this.goToBuyBtn.addEventListener('click', () => this.state.currentBlock = 1);
			this.tabs[0].addEventListener('click', () => this.state.currentBlock = 0);
			this.tabs[1].addEventListener('click', () => this.state.currentBlock = 1);
			this.popupClose.addEventListener('click', () => this.state.isPopupOpened = false);

			this.openChestBtn.addEventListener('click', () => {
				this.state.isLoading = true;

                fetch('/open_lootboxes/', {
					body: {
				 		csrfmiddlewaretoken: csrftoken,
				 		csrftoken: 1
				 	}
				 })
				sleep(2000)
					.then((res) => {
						const data = res.json();
                        this.state.goldReward = numberWithSpaces(data.gold_prize);
                        this.state.premReward = numberWithSpaces(data.prem_prize);
                        this.state.wpReward = numberWithSpaces(data.wp_prize);
						this.state.isPopupOpened = true;
						/* что-то делаем после ответа */
					})
					.catch((error) => console.warn('[CHEST_OPEN_ERROR]: ', error))
					.finally(() => this.state.isLoading = false);

				/* открыть сундук */

			});

			this.openChest10Btn.addEventListener('click', () => {
				/* открыть 10 сундуков */
			});

			this.openChestAllBtn.addEventListener('click', () => {
				/* открыть все сундуки */
			});
		}
	}

	const boxPage = new BoxPage();
</script>
