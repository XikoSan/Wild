{% extends 'player/header.html' %}
{% load static %}
{% load dict_key %}
{% load get_attr %}
{% load get_len %}
{% load l10n %}{% load i18n %}
{% block for_scripts_and_css %}
<script src='{% static "js/new_offer.js" %}?{{ csrf_token }}'></script>
{% endblock %}
{% block content %}
<script>
    var csrftoken = '{{ csrf_token }}';

    var groups_n_goods = {};

    {% for group in storage_cl|get_attr:'types' %}
        groups_n_goods['{{ group }}'] = {};
        {% for good in storage_cl|get_attr:group %}
            groups_n_goods['{{ group }}']['{{ good }}'] = '{{ storage_cl|get_attr:group|dict_key:good }}';
        {% endfor %}
    {% endfor %}
</script>
<form id="new_offer_form" role="form">
    <div class="row" style="margin-top: 1%;">
        <div class="col-xs-6 col-sm-6 col-md-6" align="right">
            Действие
        </div>
        <div class="col-xs-6 col-sm-6 col-md-6" align="left">
            <select name="action" id="action">
                <option selected value='sell'>Продажа</option>
                    <option value='buy'>Покупка</option>
            </select>
        </div>
    </div>
    <div class="row" style="margin-top: 1%;">
        <div class="col-xs-6 col-sm-6 col-md-6" align="right">
            Склад
        </div>
        <div class="col-xs-6 col-sm-6 col-md-6" align="left">
            <select name="storage" id="storage">
                {% for storage in storages %}
                <option {% if storage == storages|first %} selected {% endif %} value='{{ storage.pk }}'>{{ storage.region }}</option>
                {% endfor %}
            </select>
        </div>
    </div>
    <div class="row" style="margin-top: 1%;">
        <div class="col-xs-6 col-sm-6 col-md-6" align="right">
            Група товаров
        </div>
        <div class="col-xs-6 col-sm-6 col-md-6" align="left">
            <select id="group">
                <option id="group_default" value='default' disabled selected value>Выберите группу</option>
                {% for group in storage_cl|get_attr:'types' %}
                <option value='{{ group }}'>{{ storage_cl|get_attr:'types'|dict_key:group }}</option>
                {% endfor %}
            </select>
        </div>
    </div>
    <div class="row" style="margin-top: 1%;">
        <div class="col-xs-6 col-sm-6 col-md-6" align="right">
            Товар
        </div>
        <div class="col-xs-6 col-sm-6 col-md-6" align="left">
            <select disabled name="good" id="good">
                <option id="good_default" value='default' disabled selected value>Выберите товар</option>
                {% for group in storage_cl|get_attr:'types' %}
                    {% for good in storage_cl|get_attr:group %}
                <option id="good_{{ good }}" value='{{ good }}' style="display: none">{{ storage_cl|get_attr:group|dict_key:good }}</option>
                    {% endfor %}
                {% endfor %}
            </select>
        </div>
    </div>
    <div class="row" style="margin-top: 1%;">
        <div class="col-xs-6 col-sm-6 col-md-6" align="right">
            Количество
        </div>
        <div class="col-xs-6 col-sm-6 col-md-6" align="left">
            <input id="count" type="number" min="0" max="2147483647" value="0" step="1" name="count" maxlength="3">
        </div>
    </div>
    <div class="row" style="margin-top: 1%;">
        <div class="col-xs-6 col-sm-6 col-md-6" align="right">
            Цена
        </div>
        <div class="col-xs-3 col-sm-3 col-md-3" align="left">
            <input id="price" type="number" min="0" max="9223372036854775807" value="0" step="1" name="price">
        </div>
    </div>
    <div class="row buy_row" style="margin-top: 1%; display: none">
        <div class="col-xs-6 col-sm-6 col-md-6" align="right">
            Будет заблокировано:
        </div>
        <div class="col-xs-3 col-sm-3 col-md-3" align="left">
            <b style="color: #85bb65" id="cash_to_lock">
                $0
            </b>
        </div>
    </div>
    <div class="row" style="margin-top: 1%;">
        <div class="col-xs-12 col-sm-12 col-md-12" align="center">
            <button disabled id="accept" type="submit" class="save btn btn-info">Создать</button>
        </div>
    </div>
</form>
{% endblock %}